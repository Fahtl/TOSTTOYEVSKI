```html
<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>توستو | القائمة</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* =====================================================
           المتغيرات العامة (CSS Variables)
           ===================================================== */
        :root {
            /* الألوان الأساسية */
            --primary: #ff8c00;
            --primary-light: #ffa233;
            --primary-dark: #e67e00;
            --secondary: #6c5ce7;
            --secondary-light: #8a7cf0;
            --secondary-dark: #5a4cc7;
            --success: #28a745;
            --success-light: #48c768;
            --success-dark: #1e7e34;
            --danger: #dc3545;
            --danger-light: #e4606d;
            --danger-dark: #bd2130;
            --warning: #ffc107;
            --warning-light: #ffce3a;
            --warning-dark: #d39e00;
            --info: #17a2b8;
            --info-light: #3ab5cc;
            --info-dark: #117a8b;
            
            /* ألوان الخلفية */
            --dark-bg: #0a0a0a;
            --dark-card: #1e1e1e;
            --dark-surface: #2a2a2a;
            --light-bg: #f6f1e8;
            --light-card: #fffaf3;
            --light-surface: #ffffff;
            
            /* ألوان النصوص */
            --text-dark: #2b2b2b;
            --text-light: #ffffff;
            --text-muted: #888888;
            --text-primary: var(--primary);
            --text-secondary: var(--secondary);
            
            /* الظلال */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 5px 15px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.4);
            --shadow-primary: 0 5px 15px rgba(255, 140, 0, 0.3);
            --shadow-secondary: 0 5px 15px rgba(108, 92, 231, 0.3);
            --shadow-success: 0 5px 15px rgba(40, 167, 69, 0.3);
            --shadow-danger: 0 5px 15px rgba(220, 53, 69, 0.3);
            --shadow-inner: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            
            /* الحواف المستديرة */
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 15px;
            --radius-xl: 25px;
            --radius-full: 50px;
            --radius-circle: 50%;
            
            /* المسافات */
            --spacing-xs: 5px;
            --spacing-sm: 10px;
            --spacing-md: 15px;
            --spacing-lg: 20px;
            --spacing-xl: 30px;
            --spacing-2xl: 40px;
            --spacing-3xl: 60px;
            --spacing-4xl: 80px;
            
            /* الخطوط */
            --font-primary: 'Poppins', 'Cairo', sans-serif;
            --font-code: 'Fira Code', monospace;
            
            /* الانتقالات */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            --transition-bounce: 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            
            /* أحجام الخطوط */
            --font-xs: 12px;
            --font-sm: 14px;
            --font-md: 16px;
            --font-lg: 18px;
            --font-xl: 20px;
            --font-2xl: 24px;
            --font-3xl: 32px;
            --font-4xl: 40px;
            --font-5xl: 60px;
            --font-6xl: 72px;
            
            /* الطبقات (z-index) */
            --z-base: 1;
            --z-above: 10;
            --z-dropdown: 100;
            --z-sticky: 200;
            --z-fixed: 300;
            --z-modal: 400;
            --z-popover: 500;
            --z-tooltip: 600;
            --z-toast: 700;
        }

        /* =====================================================
           الوضع الفاتح (Light Mode)
           ===================================================== */
        [data-theme="light"] {
            --primary: #ff8c00;
            --primary-light: #ffa233;
            --primary-dark: #e67e00;
            --secondary: #6c5ce7;
            
            --dark-bg: #f6f1e8;
            --dark-card: #fffaf3;
            --dark-surface: #ffffff;
            
            --text-dark: #2b2b2b;
            --text-light: #2b2b2b;
            --text-muted: #666666;
            
            --shadow-primary: 0 5px 15px rgba(255, 140, 0, 0.2);
            --shadow-secondary: 0 5px 15px rgba(108, 92, 231, 0.2);
            --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* =====================================================
           إعادة تعيين الأنماط الأساسية
           ===================================================== */
        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: 80px;
            font-size: 16px;
        }

        body {
            font-family: var(--font-primary);
            background: var(--dark-bg);
            color: var(--text-light);
            min-height: 100vh;
            transition: background var(--transition-normal), color var(--transition-normal);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        body.rtl {
            direction: rtl;
            text-align: right;
        }

        body.ltr {
            direction: ltr;
            text-align: left;
        }

        /* =====================================================
           إخفاء شريط التمرير مع الحفاظ على الوظيفة
           ===================================================== */
        body::-webkit-scrollbar {
            width: 8px;
        }

        body::-webkit-scrollbar-track {
            background: var(--dark-surface);
        }

        body::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: var(--radius-full);
        }

        body::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }

        /* =====================================================
           الرسوم المتحركة المتقدمة
           ===================================================== */
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes spinReverse {
            from { transform: rotate(360deg); }
            to { transform: rotate(0deg); }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideInLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        @keyframes scaleIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* =====================================================
           الأنماط العامة
           ===================================================== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }

        .section {
            padding: var(--spacing-4xl) 0;
            position: relative;
            overflow: hidden;
        }

        .section-title {
            font-size: var(--font-5xl);
            font-weight: 800;
            color: var(--primary);
            text-align: center;
            margin-bottom: var(--spacing-4xl);
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
            text-shadow: 0 0 30px var(--primary);
            letter-spacing: 2px;
        }

        body.rtl .section-title {
            left: auto;
            right: 50%;
            transform: translateX(50%);
        }

        .section-title::before,
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            height: 4px;
            border-radius: var(--radius-full);
        }

        .section-title::before {
            width: 150px;
            background: var(--primary);
            opacity: 0.5;
        }

        .section-title::after {
            width: 75px;
            background: var(--primary-light);
            bottom: -24px;
        }

        /* =====================================================
           القسم الرئيسي
           ===================================================== */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.4) 100%),
                        url('https://images.unsplash.com/photo-1528735602780-2552fd46c7af?w=1600') center/cover fixed;
            text-align: center;
            padding: var(--spacing-2xl);
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,140,0,0.2) 0%, transparent 60%);
            animation: spin 40s linear infinite;
            pointer-events: none;
        }

        .hero::after {
            content: '';
            position: absolute;
            bottom: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(108,92,231,0.15) 0%, transparent 60%);
            animation: spinReverse 50s linear infinite;
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: var(--z-above);
            max-width: 800px;
        }

        .hero h1 {
            font-size: clamp(var(--font-5xl), 15vw, var(--font-6xl));
            font-weight: 900;
            color: var(--primary);
            text-shadow: 0 0 40px var(--primary), 0 0 80px rgba(255,140,0,0.5);
            margin-bottom: var(--spacing-xl);
            animation: float 4s ease-in-out infinite;
            letter-spacing: 4px;
            cursor: pointer;
        }

        .hero h1:hover {
            animation: pulse 1s ease-in-out infinite;
        }

        .hero .work-time {
            font-size: var(--font-2xl);
            font-weight: 600;
            color: var(--primary);
            background: rgba(255,140,0,0.15);
            backdrop-filter: blur(10px);
            padding: var(--spacing-md) var(--spacing-2xl);
            border-radius: var(--radius-full);
            border: 2px solid rgba(255,140,0,0.3);
            margin-bottom: var(--spacing-2xl);
            animation: pulse 2s ease-in-out infinite;
            display: inline-block;
            box-shadow: var(--shadow-lg);
        }

        .hero .btn {
            animation: bounce 2s ease-in-out infinite;
        }

        /* =====================================================
           الأزرار
           ===================================================== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-2xl);
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-lg);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            background: var(--primary);
            color: var(--text-light);
            box-shadow: var(--shadow-primary);
            text-decoration: none;
            min-width: 180px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: var(--radius-circle);
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255,140,0,0.5);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn i {
            font-size: var(--font-xl);
            transition: transform var(--transition-normal);
        }

        .btn:hover i {
            transform: scale(1.2) rotate(5deg);
        }

        .btn-secondary {
            background: var(--secondary);
            box-shadow: var(--shadow-secondary);
        }

        .btn-success {
            background: var(--success);
            box-shadow: var(--shadow-success);
        }

        .btn-danger {
            background: var(--danger);
            box-shadow: var(--shadow-danger);
        }

        .btn-sm {
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: var(--font-sm);
            min-width: 120px;
        }

        .btn-icon {
            width: 50px;
            height: 50px;
            padding: 0;
            min-width: unset;
            border-radius: var(--radius-circle);
        }

        /* =====================================================
           البطاقات
           ===================================================== */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--spacing-2xl);
            padding: var(--spacing-lg);
        }

        .card {
            background: var(--dark-card);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all var(--transition-normal);
            border: 2px solid transparent;
            box-shadow: var(--shadow-xl);
            position: relative;
            animation: fadeIn 0.6s ease-out;
            backdrop-filter: blur(10px);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,140,0,0.2), transparent);
            transition: left 0.5s ease;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-15px) scale(1.02);
            border-color: var(--primary);
            box-shadow: 0 40px 60px rgba(255,140,0,0.4);
        }

        .card-image-container {
            width: 100%;
            height: 220px;
            overflow: hidden;
            position: relative;
        }

        .card-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 1s;
            cursor: pointer;
        }

        .card:hover .card-image {
            transform: scale(1.15);
        }

        .card-header {
            padding: var(--spacing-xl);
            border-bottom: 2px solid rgba(255,140,0,0.3);
            position: relative;
            background: rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            font-size: var(--font-2xl);
            color: var(--primary);
            font-weight: 700;
            margin: 0;
            text-shadow: 0 0 10px rgba(255,140,0,0.5);
            flex: 1;
        }

        .card-body {
            padding: var(--spacing-xl);
        }

        .delete-card-btn {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            width: 40px;
            height: 40px;
            border-radius: var(--radius-circle);
            background: var(--danger);
            color: white;
            border: 2px solid white;
            cursor: pointer;
            opacity: 0;
            transition: all var(--transition-normal);
            z-index: var(--z-above);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-lg);
            box-shadow: var(--shadow-danger);
        }

        body.rtl .delete-card-btn {
            right: auto;
            left: var(--spacing-md);
        }

        .card:hover .delete-card-btn {
            opacity: 1;
        }

        .delete-card-btn:hover {
            transform: scale(1.15) rotate(90deg);
        }

        /* =====================================================
           عناصر القائمة
           ===================================================== */
        .items-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md);
            background: rgba(0,0,0,0.2);
            border-radius: var(--radius-md);
            border: 1px dashed rgba(255,140,0,0.2);
            transition: all var(--transition-normal);
            position: relative;
            animation: slideInLeft 0.5s ease-out;
            cursor: pointer;
            overflow: hidden;
        }

        .item:hover {
            transform: translateX(8px);
            border-color: var(--primary);
            background: rgba(255,140,0,0.15);
            box-shadow: var(--shadow-md);
        }

        body.rtl .item:hover {
            transform: translateX(-8px);
        }

        .item.has-image {
            padding-left: 80px;
            min-height: 80px;
        }

        body.rtl .item.has-image {
            padding-left: var(--spacing-md);
            padding-right: 80px;
        }

        .item-image {
            position: absolute;
            left: var(--spacing-sm);
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 60px;
            border-radius: var(--radius-md);
            object-fit: cover;
            border: 2px solid var(--primary);
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-sm);
            cursor: pointer;
        }

        body.rtl .item-image {
            left: auto;
            right: var(--spacing-sm);
        }

        .item:hover .item-image {
            transform: translateY(-50%) scale(1.1) rotate(5deg);
            border-color: var(--primary-light);
            box-shadow: var(--shadow-primary);
        }

        .delete-mode .item:hover {
            outline: 2px solid var(--danger);
            background: rgba(220,53,69,0.1);
        }

        .edit-mode .item:hover {
            outline: 2px solid var(--success);
            background: rgba(40,167,69,0.1);
        }

        .item-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .item-name {
            color: var(--primary);
            font-weight: 600;
            font-size: var(--font-lg);
            transition: color var(--transition-normal);
            cursor: pointer;
        }

        .edit-mode .item-name {
            color: var(--success);
            text-decoration: underline;
        }

        .item:hover .item-name {
            color: var(--primary-light);
        }

        .item-price {
            font-weight: 700;
            font-size: var(--font-lg);
            padding: var(--spacing-xs) var(--spacing-md);
            background: rgba(255,140,0,0.2);
            border-radius: var(--radius-full);
            transition: all var(--transition-normal);
            white-space: nowrap;
            border: 1px solid rgba(255,140,0,0.3);
            cursor: pointer;
        }

        .edit-mode .item-price {
            color: var(--warning);
            text-decoration: underline;
        }

        .item:hover .item-price {
            background: rgba(255,140,0,0.4);
            transform: scale(1.05);
            border-color: var(--primary);
        }

        .item-actions {
            display: flex;
            gap: var(--spacing-xs);
            margin-left: var(--spacing-md);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        body.rtl .item-actions {
            margin-left: 0;
            margin-right: var(--spacing-md);
        }

        .item:hover .item-actions {
            opacity: 1;
        }

        .item-edit-btn,
        .item-delete-btn {
            width: 35px;
            height: 35px;
            border-radius: var(--radius-circle);
            border: none;
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-md);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .item-edit-btn {
            background: var(--success);
        }

        .item-delete-btn {
            background: var(--danger);
        }

        .item-edit-btn:hover,
        .item-delete-btn:hover {
            transform: scale(1.15);
        }

        /* =====================================================
           قسم الاتصال
           ===================================================== */
        .contact-section {
            background: #000;
            position: relative;
            overflow: hidden;
            padding: var(--spacing-4xl) 0;
        }

        .contact-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,140,0,0.15) 0%, transparent 70%);
            animation: spin 40s linear infinite;
            pointer-events: none;
        }

        .contact-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--spacing-3xl);
            position: relative;
            z-index: var(--z-above);
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xl);
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-xl);
            padding: var(--spacing-xl);
            background: rgba(255,255,255,0.05);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(10px);
            transition: all var(--transition-normal);
            border: 1px solid rgba(255,140,0,0.1);
        }

        .contact-item:hover {
            transform: translateX(15px);
            background: rgba(255,140,0,0.15);
            border-color: var(--primary);
            box-shadow: var(--shadow-primary);
        }

        body.rtl .contact-item:hover {
            transform: translateX(-15px);
        }

        .contact-icon {
            width: 70px;
            height: 70px;
            background: var(--primary);
            border-radius: var(--radius-circle);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-3xl);
            color: white;
            box-shadow: var(--shadow-primary);
        }

        .contact-item:hover .contact-icon {
            transform: scale(1.1) rotate(10deg);
        }

        .contact-text {
            font-size: var(--font-xl);
            font-weight: 500;
        }

        .contact-text a {
            color: var(--primary);
            text-decoration: none;
            transition: color var(--transition-normal);
            position: relative;
        }

        .contact-text a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width var(--transition-normal);
        }

        .contact-text a:hover::after {
            width: 100%;
        }

        .map-container {
            width: 100%;
            height: 450px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            border: 2px solid var(--primary);
        }

        .map-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* =====================================================
           عناصر التحكم
           ===================================================== */
        .floating-controls {
            position: fixed;
            top: var(--spacing-xl);
            right: var(--spacing-xl);
            display: flex;
            gap: var(--spacing-sm);
            z-index: var(--z-fixed);
        }

        body.rtl .floating-controls {
            right: auto;
            left: var(--spacing-xl);
        }

        .control-btn {
            width: 55px;
            height: 55px;
            border-radius: var(--radius-circle);
            border: 2px solid rgba(255,255,255,0.2);
            background: var(--primary);
            color: white;
            font-size: var(--font-2xl);
            cursor: pointer;
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .control-btn:hover {
            transform: scale(1.15) rotate(10deg);
            background: var(--primary-light);
        }

        .language-menu {
            position: fixed;
            top: calc(var(--spacing-xl) * 2 + 55px);
            right: var(--spacing-xl);
            background: rgba(26, 26, 26, 0.98);
            border: 2px solid var(--primary);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
            display: none;
            flex-direction: column;
            gap: var(--spacing-xs);
            min-width: 220px;
            z-index: var(--z-modal);
            box-shadow: var(--shadow-xl);
            backdrop-filter: blur(10px);
        }

        body.rtl .language-menu {
            right: auto;
            left: var(--spacing-xl);
        }

        .language-btn {
            padding: var(--spacing-md);
            background: transparent;
            border: 1px solid rgba(255,140,0,0.3);
            border-radius: var(--radius-md);
            color: white;
            cursor: pointer;
            transition: all var(--transition-normal);
            text-align: left;
            font-size: var(--font-md);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        body.rtl .language-btn {
            text-align: right;
        }

        .language-btn:hover {
            background: var(--primary);
            transform: translateX(8px);
            border-color: var(--primary);
        }

        body.rtl .language-btn:hover {
            transform: translateX(-8px);
        }

        .floating-dev-btn {
            position: fixed;
            bottom: var(--spacing-2xl);
            right: var(--spacing-2xl);
            width: 80px;
            height: 80px;
            border-radius: var(--radius-circle);
            background: var(--primary);
            color: white;
            border: 3px solid white;
            font-size: var(--font-3xl);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: var(--z-fixed);
            animation: float 3s ease-in-out infinite;
            box-shadow: var(--shadow-xl);
        }

        body.rtl .floating-dev-btn {
            right: auto;
            left: var(--spacing-2xl);
        }

        .floating-dev-btn:hover {
            transform: scale(1.15) rotate(15deg);
            background: var(--primary-light);
        }

        .live-badge {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 0, 0, 0.9);
            color: #fff;
            padding: 6px 16px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: bold;
            z-index: 100;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(255,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.3);
            animation: pulse 1.5s infinite;
        }

        body.rtl .live-badge {
            left: auto;
            right: 20px;
        }

        .version-tag {
            font-size: 10px;
            background: #333;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
        }

        /* =====================================================
           النوافذ المشروطة
           ===================================================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
        }

        .modal {
            background: var(--dark-card);
            border: 3px solid var(--primary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            max-width: 90%;
            width: 550px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 2px solid rgba(255,140,0,0.3);
        }

        .modal-header h3 {
            color: var(--primary);
            font-size: var(--font-2xl);
            font-weight: 700;
            margin: 0;
        }

        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-circle);
            background: var(--danger);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-xl);
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-danger);
        }

        .modal-close:hover {
            transform: scale(1.15) rotate(90deg);
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-md);
            padding-top: var(--spacing-lg);
            border-top: 2px solid rgba(255,140,0,0.3);
        }

        /* =====================================================
           نافذة الفيديو
           ===================================================== */
        .video-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.95);
            backdrop-filter: blur(10px);
        }

        .video-modal-content {
            position: relative;
            margin: auto;
            width: 90%;
            max-width: 800px;
        }

        .video-modal-close {
            position: absolute;
            top: -40px;
            right: 0;
            color: white;
            font-size: 35px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            border: 2px solid var(--primary);
            transition: all var(--transition-normal);
        }

        body.rtl .video-modal-close {
            right: auto;
            left: 0;
        }

        .video-modal-close:hover {
            transform: rotate(90deg);
            background: var(--primary);
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: var(--radius-lg);
            border: 3px solid var(--primary);
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .video-counter {
            text-align: center;
            margin-top: 20px;
            color: var(--primary);
            font-size: 18px;
        }

        /* =====================================================
           نافذة تكبير الصور
           ===================================================== */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 2500;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.95);
            backdrop-filter: blur(10px);
        }

        .image-modal.show {
            display: flex;
        }

        .image-modal-content {
            position: relative;
            margin: auto;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .image-modal-close {
            position: absolute;
            top: -40px;
            right: 0;
            color: white;
            font-size: 35px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            border: 2px solid var(--primary);
            transition: all var(--transition-normal);
        }

        body.rtl .image-modal-close {
            right: auto;
            left: 0;
        }

        .image-modal-close:hover {
            transform: rotate(90deg);
            background: var(--primary);
        }

        .image-modal-img-container {
            width: 100%;
            max-height: 70vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.5);
            border-radius: var(--radius-lg);
            border: 3px solid var(--primary);
            overflow: hidden;
        }

        .image-modal-img {
            max-width: 100%;
            max-height: 70vh;
            object-fit: contain;
        }

        .image-modal-info {
            text-align: center;
            margin-top: 20px;
            color: white;
            font-size: 18px;
            background: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid var(--primary);
        }

        .image-modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 40px;
            color: white;
            cursor: pointer;
            padding: 10px 20px;
            background: rgba(255,140,0,0.3);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--primary);
            transition: all var(--transition-normal);
        }

        .image-modal-nav:hover {
            background: var(--primary);
            transform: translateY(-50%) scale(1.1);
        }

        .image-modal-nav.prev { left: 20px; }
        .image-modal-nav.next { right: 20px; }

        body.rtl .image-modal-nav.prev { left: auto; right: 20px; }
        body.rtl .image-modal-nav.next { right: auto; left: 20px; }

        .image-modal-nav.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* =====================================================
           نوافذ المطور
           ===================================================== */
        .dev-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 95%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            background: rgba(26, 26, 26, 0.98);
            border: 3px solid var(--primary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            z-index: var(--z-popover);
            display: none;
            box-shadow: var(--shadow-xl);
            backdrop-filter: blur(10px);
        }

        body.rtl .dev-window {
            direction: ltr;
        }

        .dev-window.v2 {
            max-width: 800px;
            border-color: var(--secondary);
        }

        .dev-window .window-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-2xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 2px solid rgba(255,140,0,0.3);
            cursor: move;
        }

        .dev-window .window-header h3 {
            color: var(--primary);
            font-size: var(--font-2xl);
            font-weight: 700;
            margin: 0;
        }

        .dev-window.v2 .window-header h3 {
            color: var(--secondary);
        }

        .dev-section {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,140,0,0.2);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
        }

        .dev-section.v2 {
            border-color: rgba(108,92,231,0.2);
        }

        .dev-section h4 {
            color: var(--primary);
            font-size: var(--font-xl);
            margin-bottom: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .dev-section.v2 h4 {
            color: var(--secondary);
        }

        .form-group {
            margin-bottom: var(--spacing-lg);
        }

        .form-label {
            display: block;
            margin-bottom: var(--spacing-sm);
            color: var(--primary);
            font-weight: 600;
            font-size: var(--font-md);
        }

        .form-control {
            width: 100%;
            padding: var(--spacing-md);
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(255,140,0,0.3);
            border-radius: var(--radius-md);
            color: var(--text-light);
            font-size: var(--font-md);
            transition: all var(--transition-normal);
            font-family: var(--font-primary);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(255,140,0,0.2);
        }

        select.form-control {
            cursor: pointer;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--spacing-sm);
            margin: var(--spacing-lg) 0;
        }

        .code-display {
            background: #0a0a0a;
            border: 1px solid var(--primary);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            font-family: var(--font-code);
            font-size: var(--font-sm);
            max-height: 200px;
            overflow: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-top: var(--spacing-lg);
        }

        .image-gallery {
            max-height: 200px;
            overflow-y: auto;
            padding: var(--spacing-md);
            background: rgba(0,0,0,0.3);
            border-radius: var(--radius-md);
        }

        .category-with-image,
        .product-with-image {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 5px 0;
            padding: 5px;
            background: rgba(255,140,0,0.1);
            border-radius: 5px;
            cursor: pointer;
        }

        .category-with-image img,
        .product-with-image img {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .image-preview {
            width: 100%;
            height: 150px;
            background: #333;
            border-radius: var(--radius-md);
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px solid var(--primary);
        }

        .image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }

        .cloud-panel {
            margin-top: 15px;
            background: rgba(0, 150, 255, 0.1);
            border: 1px solid #0099ff;
            padding: 10px;
            border-radius: 8px;
        }

        .cloud-stats {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 6px;
            font-size: 13px;
        }

        .cloud-badge {
            background: #0066cc;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            display: inline-block;
            margin-left: 5px;
        }

        .backup-section {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
        }

        .code-export {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        /* =====================================================
           نافذة تأكيد
           ===================================================== */
        .custom-confirm-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--dark-card);
            border: 3px solid var(--primary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            z-index: 3000;
            display: none;
            flex-direction: column;
            gap: var(--spacing-xl);
            min-width: 350px;
            text-align: center;
            box-shadow: var(--shadow-xl);
        }

        .confirm-buttons {
            display: flex;
            gap: var(--spacing-lg);
            justify-content: center;
        }

        .confirm-btn {
            padding: var(--spacing-md) var(--spacing-xl);
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--font-lg);
            font-weight: bold;
            flex: 1;
            transition: all var(--transition-normal);
        }

        .confirm-btn.yes { background: var(--danger); color: white; }
        .confirm-btn.no { background: var(--secondary); color: white; }
        .confirm-btn:hover { transform: translateY(-3px); }

        /* =====================================================
           نافذة اختيار الألوان
           ===================================================== */
        .color-picker-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--dark-card);
            border: 3px solid var(--primary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            z-index: 2500;
            display: none;
            flex-direction: column;
            gap: var(--spacing-lg);
            min-width: 350px;
            box-shadow: var(--shadow-xl);
        }

        .color-picker-modal h3 {
            color: var(--primary);
            text-align: center;
        }

        .color-picker-modal input[type=color] {
            width: 100%;
            height: 50px;
            border: 2px solid var(--primary);
            border-radius: var(--radius-md);
            background: transparent;
            cursor: pointer;
            margin: 10px 0;
        }

        /* =====================================================
           رسائل الحالة
           ===================================================== */
        .toast-container {
            position: fixed;
            top: var(--spacing-xl);
            right: var(--spacing-xl);
            z-index: var(--z-toast);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        body.rtl .toast-container {
            right: auto;
            left: var(--spacing-xl);
        }

        .status-message {
            background: rgba(26, 26, 26, 0.98);
            border: 2px solid;
            border-radius: var(--radius-lg);
            padding: var(--spacing-md) var(--spacing-xl);
            color: white;
            font-weight: 600;
            animation: slideInRight var(--transition-normal);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
            min-width: 300px;
            box-shadow: var(--shadow-xl);
        }

        body.rtl .status-message {
            animation: slideInLeft var(--transition-normal);
        }

        .status-success { border-color: var(--success); }
        .status-error { border-color: var(--danger); }
        .status-loading { border-color: var(--primary); }

        /* =====================================================
           التجاوب مع الشاشات
           ===================================================== */
        @media (max-width: 1200px) {
            :root {
                --font-6xl: 60px;
                --font-5xl: 48px;
                --spacing-4xl: 60px;
            }
        }

        @media (max-width: 992px) {
            :root {
                --font-6xl: 48px;
                --font-5xl: 40px;
                --spacing-4xl: 50px;
            }
            
            .contact-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            :root {
                --font-6xl: 40px;
                --font-5xl: 36px;
                --spacing-4xl: 40px;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .floating-controls {
                top: var(--spacing-lg);
                right: var(--spacing-lg);
            }
            
            .floating-dev-btn {
                width: 70px;
                height: 70px;
                font-size: var(--font-2xl);
                bottom: var(--spacing-xl);
                right: var(--spacing-xl);
            }
            
            .dev-window {
                width: 98%;
                padding: var(--spacing-lg);
            }
            
            .image-modal-nav {
                font-size: 30px;
                width: 40px;
                height: 40px;
            }
            
            .image-modal-nav.prev { left: 5px; }
            .image-modal-nav.next { right: 5px; }
            .image-modal-close { top: -50px; }
        }

        @media (max-width: 576px) {
            :root {
                --font-6xl: 36px;
                --font-5xl: 32px;
                --spacing-4xl: 30px;
            }
            
            .hero h1 {
                font-size: 40px;
            }
            
            .hero .work-time {
                font-size: var(--font-lg);
                padding: var(--spacing-sm) var(--spacing-lg);
            }
            
            .btn {
                padding: var(--spacing-sm) var(--spacing-lg);
                min-width: 140px;
                font-size: var(--font-md);
            }
            
            .modal {
                padding: var(--spacing-lg);
            }
            
            .contact-item {
                flex-direction: column;
                text-align: center;
                padding: var(--spacing-lg);
            }
            
            .contact-icon {
                width: 60px;
                height: 60px;
                font-size: var(--font-2xl);
            }
            
            .status-message {
                min-width: auto;
                width: 90%;
                right: 5%;
                left: 5%;
            }
        }
    </style>
</head>
<body dir="rtl" data-theme="dark" data-language="ar">

<!-- ===== نافذة الفيديو المخفي ===== -->
<div class="video-modal" id="videoModal">
    <div class="video-modal-content">
        <span class="video-modal-close" onclick="window.closeVideoModal()">&times;</span>
        <div class="video-container">
            <iframe id="videoFrame" src="" allowfullscreen></iframe>
        </div>
        <div class="video-counter" id="videoCounter">🎬 فيديو خاص!</div>
    </div>
</div>

<!-- ===== نافذة تكبير الصور ===== -->
<div class="image-modal" id="imageModal">
    <div class="image-modal-content">
        <span class="image-modal-close" onclick="window.closeImageModal()">&times;</span>
        <div class="image-modal-nav prev" onclick="window.navigateImage(-1)">&#10094;</div>
        <div class="image-modal-nav next" onclick="window.navigateImage(1)">&#10095;</div>
        <div class="image-modal-img-container">
            <img class="image-modal-img" id="modalImage" src="" alt="">
        </div>
        <div class="image-modal-info" id="modalImageInfo"></div>
    </div>
</div>

<!-- قائمة اللغات -->
<div class="language-menu" id="languageMenu">
    <button class="language-btn" onclick="window.setLanguage('ar')">
        <span>🇮🇶 العربية</span>
    </button>
    <button class="language-btn" onclick="window.setLanguage('tr')">
        <span>🇹🇷 Türkçe</span>
    </button>
    <button class="language-btn" onclick="window.setLanguage('en')">
        <span>🇬🇧 English</span>
    </button>
    <button class="language-btn" onclick="window.setLanguage('ru')">
        <span>🇷🇺 Русский</span>
    </button>
</div>

<!-- نافذة اختيار نسخة المطور -->
<div class="modal-overlay" id="devVersionModal">
    <div class="modal">
        <div class="modal-header">
            <h3>🔧 خيارات المطور</h3>
            <button class="modal-close" onclick="window.closeVersionModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <p class="text-center mb-4">أي إصدار تريد استخدامه؟</p>
            <div class="button-group">
                <button class="btn btn-primary" onclick="window.selectDevVersion('v1')">
                    <i class="fas fa-cog"></i> V1 (كلاسيكي)
                </button>
                <button class="btn btn-secondary" onclick="window.selectDevVersion('v2')">
                    <i class="fas fa-paint-brush"></i> V2 (متقدم)
                </button>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-danger" onclick="window.closeVersionModal()">
                <i class="fas fa-times"></i> إغلاق
            </button>
        </div>
    </div>
</div>

<!-- نافذة تأكيد الحذف -->
<div class="custom-confirm-modal" id="customConfirmModal">
    <h3 id="confirmTitle">⚠️ تأكيد</h3>
    <p id="confirmMessage">هل أنت متأكد من هذه العملية؟</p>
    <div class="confirm-buttons">
        <button class="confirm-btn yes" id="confirmYesBtn">نعم</button>
        <button class="confirm-btn no" id="confirmNoBtn">لا</button>
    </div>
</div>

<!-- نافذة اختيار الألوان -->
<div class="color-picker-modal" id="colorPickerModal">
    <h3>🎨 تخصيص الألوان</h3>
    <label>لون عنوان الفئة</label>
    <input type="color" id="colorCategory" value="#ff8c00">
    <label>لون اسم المنتج</label>
    <input type="color" id="colorName" value="#ff8c00">
    <label>لون السعر</label>
    <input type="color" id="colorPrice" value="#ffffff">
    <div class="button-group">
        <button class="btn btn-success" onclick="window.applyColors()">تطبيق</button>
        <button class="btn btn-danger" onclick="window.closeColorPicker()">إلغاء</button>
    </div>
</div>

<!-- لوحة المطور V1 -->
<div class="dev-window" id="devPanelV1">
    <div class="window-header" id="dragHandle">
        <h3><i class="fas fa-cog"></i> لوحة المطور V1</h3>
        <button class="modal-close" onclick="window.closeDevV1()">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <div class="dev-section">
        <h4><i class="fas fa-plus-circle"></i> إضافة منتج</h4>
        <div class="form-group">
            <label class="form-label">اختر الفئة</label>
            <select id="categorySelect" class="form-control"></select>
        </div>
        <div class="form-group">
            <label class="form-label">اسم المنتج</label>
            <input type="text" id="newName" class="form-control" placeholder="اسم المنتج">
        </div>
        <div class="form-group">
            <label class="form-label">السعر</label>
            <input type="text" id="productPrice" class="form-control" placeholder="السعر">
        </div>
        <button class="btn btn-success btn-block" onclick="window.addProduct()">
            <i class="fas fa-check"></i> إضافة منتج
        </button>
    </div>

    <div class="dev-section">
        <h4><i class="fas fa-folder-plus"></i> إضافة فئة</h4>
        <div class="form-group">
            <label class="form-label">اسم الفئة الجديدة</label>
            <input type="text" id="newCategory" class="form-control" placeholder="اسم الفئة">
        </div>
        <button class="btn btn-success btn-block" onclick="window.addCategory()">
            <i class="fas fa-folder-plus"></i> إضافة فئة
        </button>
    </div>

    <div class="dev-section">
        <h4><i class="fas fa-palette"></i> تعديل الألوان</h4>
        <button class="btn btn-primary btn-block" onclick="window.openColorPicker()">
            <i class="fas fa-palette"></i> فتح منتقي الألوان
        </button>
    </div>

    <div class="dev-section">
        <h4><i class="fas fa-tools"></i> الأدوات</h4>
        <div class="button-group">
            <button class="btn btn-success" onclick="window.enableEdit()">
                <i class="fas fa-edit"></i> وضع التعديل
            </button>
            <button class="btn btn-danger" onclick="window.enableDelete()">
                <i class="fas fa-trash"></i> وضع الحذف
            </button>
        </div>
        <button class="btn btn-secondary btn-block" onclick="window.disableAllModes()">
            <i class="fas fa-times"></i> إلغاء الأوضاع
        </button>
        <button class="btn btn-warning btn-block" onclick="window.resetToOriginal()">
            <i class="fas fa-undo"></i> إعادة تعيين القائمة
        </button>
    </div>

    <div class="dev-section">
        <h4><i class="fas fa-globe"></i> وسائل التواصل</h4>
        <div class="form-group">
            <label class="form-label">رابط إنستغرام</label>
            <input type="text" id="newInstagram" class="form-control" placeholder="https://instagram.com/...">
        </div>
        <button class="btn btn-info btn-block" onclick="window.changeInstagram()">
            <i class="fab fa-instagram"></i> تحديث إنستغرام
        </button>
        <div class="form-group">
            <label class="form-label">الموقع (خط العرض،خط الطول)</label>
            <input type="text" id="newLocation" class="form-control" placeholder="36.484479,32.101147">
        </div>
        <button class="btn btn-info btn-block" onclick="window.changeLocation()">
            <i class="fas fa-map-marker-alt"></i> تحديث الموقع
        </button>
    </div>

    <div class="dev-section" style="border-color: #00ff00; background: rgba(0,255,0,0.1);">
        <h4><i class="fas fa-cloud"></i> CLOUD SYNC <span class="cloud-badge">متقدم</span></h4>
        <div class="cloud-panel">
            <div class="cloud-stats">
                <span>🌐 API: <span style="color:#00ff00" id="apiStatus">جاهز</span></span>
                <span>📦 الإصدار: <span id="cloudVersion">1.0.0</span></span>
            </div>
            <div class="cloud-stats">
                <span>💾 آخر حفظ: <span id="lastCloudSave">-</span></span>
                <span>🔄 الحالة: <span id="syncStatus">جاهز</span></span>
            </div>
            
            <div style="background:#0066cc; padding:8px; border-radius:6px; margin-bottom:10px; text-align:center; word-break:break-all;">
                🔗 <strong>API URL:</strong><br>
                <span style="font-size:11px;">https://api.npoint.io/2b9acf08c13ba5b3b27a</span>
            </div>
            
            <button class="btn btn-info btn-block" onclick="window.saveToCloud()" id="cloudSaveBtn">
                <i class="fas fa-cloud-upload-alt"></i> حفظ في السحابة
            </button>
            <button class="btn btn-secondary btn-block" onclick="window.loadFromCloud()" id="cloudLoadBtn">
                <i class="fas fa-cloud-download-alt"></i> تحميل من السحابة
            </button>
            <button class="btn btn-success btn-block" onclick="window.testCloudConnection()">
                <i class="fas fa-plug"></i> اختبار الاتصال
            </button>
            
            <div class="backup-section">
                <div class="code-export">
                    <button class="btn btn-sm btn-info" onclick="window.copyBackupCode()">
                        <i class="fas fa-copy"></i> نسخ الكود
                    </button>
                    <button class="btn btn-sm btn-info" onclick="window.pasteBackupCode()">
                        <i class="fas fa-paste"></i> لصق الكود
                    </button>
                </div>
                <small>انسخ الكود وأرسله لي للتعديل</small>
            </div>
        </div>
    </div>

    <div class="dev-section">
        <h4><i class="fas fa-code"></i> نسخ الكود</h4>
        <div class="code-display" id="v1CodeDisplay"></div>
        <button class="btn btn-info btn-block" onclick="window.copyV1Code()">
            <i class="fas fa-copy"></i> نسخ الكود
        </button>
    </div>

    <button class="btn btn-danger btn-block" onclick="window.closeDevV1()">
        <i class="fas fa-times"></i> إغلاق
    </button>
</div>

<!-- لوحة المطور V2 -->
<div class="dev-window v2" id="devPanelV2">
    <div class="window-header">
        <h3><i class="fas fa-paint-brush"></i> لوحة المطور V2 (صور)</h3>
        <button class="modal-close" onclick="window.closeDevV2()">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <div class="dev-section v2">
        <h4><i class="fas fa-folder-plus"></i> إضافة صورة للفئة</h4>
        <div class="form-group">
            <label class="form-label">اختر الفئة</label>
            <select id="categoryImageSelect" class="form-control">
                <option value="">اختر الفئة</option>
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">رابط الصورة</label>
            <input type="url" id="categoryImageUrl" class="form-control" placeholder="https://...">
        </div>
        <div class="image-preview" id="categoryImagePreview">
            <span>معاينة الصورة</span>
        </div>
        <div class="button-group">
            <button class="btn btn-secondary" onclick="window.previewCategoryImage()">
                <i class="fas fa-eye"></i> معاينة
            </button>
            <button class="btn btn-success" onclick="window.addCategoryImage()">
                <i class="fas fa-check"></i> إضافة
            </button>
            <button class="btn btn-danger" onclick="window.deleteCategoryImage()">
                <i class="fas fa-trash"></i> حذف
            </button>
        </div>
    </div>

    <div class="dev-section v2">
        <h4><i class="fas fa-plus-circle"></i> إضافة صورة لمنتج</h4>
        <div class="form-group">
            <label class="form-label">اختر الفئة</label>
            <select id="productCategorySelect" class="form-control">
                <option value="">اختر الفئة</option>
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">اختر المنتج</label>
            <select id="productSelect" class="form-control" disabled>
                <option value="">اختر الفئة أولاً</option>
            </select>
        </div>
        <div class="form-group">
            <label class="form-label">رابط الصورة</label>
            <input type="url" id="productImageUrl" class="form-control" placeholder="https://...">
        </div>
        <div class="image-preview" id="productImagePreview">
            <span>معاينة الصورة</span>
        </div>
        <div class="button-group">
            <button class="btn btn-secondary" onclick="window.previewProductImage()">
                <i class="fas fa-eye"></i> معاينة
            </button>
            <button class="btn btn-success" onclick="window.addProductImage()">
                <i class="fas fa-check"></i> إضافة
            </button>
            <button class="btn btn-danger" onclick="window.deleteProductImage()">
                <i class="fas fa-trash"></i> حذف
            </button>
        </div>
    </div>

    <div class="dev-section v2">
        <h4><i class="fas fa-images"></i> معرض الصور</h4>
        <div class="image-gallery" id="imageGallery"></div>
    </div>

    <div class="dev-section v2">
        <h4><i class="fas fa-trash-alt"></i> حذف مجمع</h4>
        <div class="button-group">
            <button class="btn btn-warning" onclick="window.deleteAllCategoryImages()">
                <i class="fas fa-folder"></i> حذف صور الفئات
            </button>
            <button class="btn btn-warning" onclick="window.deleteAllProductImages()">
                <i class="fas fa-box"></i> حذف صور المنتجات
            </button>
        </div>
        <button class="btn btn-danger btn-block" onclick="window.deleteAllImages()">
            <i class="fas fa-trash"></i> حذف جميع الصور
        </button>
    </div>

    <div class="dev-section v2">
        <h4><i class="fas fa-cloud"></i> مزامنة الصور</h4>
        <div class="button-group">
            <button class="btn btn-info" onclick="window.saveImagesToCloud()">
                <i class="fas fa-cloud-upload-alt"></i> حفظ الصور
            </button>
            <button class="btn btn-secondary" onclick="window.loadImagesFromCloud()">
                <i class="fas fa-cloud-download-alt"></i> تحميل الصور
            </button>
        </div>
    </div>

    <button class="btn btn-danger btn-block" onclick="window.closeDevV2()">
        <i class="fas fa-times"></i> إغلاق
    </button>
</div>

<!-- عناصر التحكم العلوية -->
<div class="floating-controls">
    <button class="control-btn" id="langBtn" onclick="window.toggleLanguageMenu()" title="تغيير اللغة">
        <i class="fas fa-globe"></i>
    </button>
    <button class="control-btn" id="themeToggle" onclick="window.toggleMode()" title="تغيير السمة">
        <i class="fas fa-moon"></i>
    </button>
</div>

<!-- زر المطور العائم (يظهر بعد فتح لوحة المطور) -->
<div class="floating-dev-btn" id="floatingDevBtn" onclick="window.toggleDevPanel()" style="display: none;">
    <i class="fas fa-code"></i>
</div>

<!-- شارة مباشر -->
<div class="live-badge" id="liveBadge">🔴 مباشر</div>

<!-- القسم الرئيسي -->
<section class="hero">
    <div class="hero-content">
        <h1 id="secretTrigger">توستو</h1>
        <div class="work-time" id="workTime">🕒 ٠٨:٠٠ - ٠٢:٣٠</div>
        <button class="btn" onclick="window.scrollToMenu()" id="scrollBtn">عرض القائمة</button>
    </div>
</section>

<!-- قسم القائمة -->
<section id="menu" class="section">
    <div class="container">
        <h2 class="section-title" id="menuTitle">قائمتنا <span class="version-tag" id="liveVersion">v1.0</span></h2>
        <div class="grid" id="menuGrid"></div>
    </div>
</section>

<!-- قسم الاتصال -->
<section id="contact" class="contact-section">
    <div class="container">
        <h2 class="section-title" id="contactTitle">اتصل بنا</h2>
        <div class="contact-content">
            <div class="contact-info">
                <div class="contact-item">
                    <div class="contact-icon">
                        <i class="fas fa-phone-alt"></i>
                    </div>
                    <div class="contact-text" id="phoneLink">
                        📞 0532 158 02 07
                    </div>
                </div>
                <div class="contact-item">
                    <div class="contact-icon">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <div class="contact-text">
                        <a id="instaLink" href="https://www.instagram.com/tosttoo" target="_blank">إنستغرام</a>
                    </div>
                </div>
                <div class="contact-item">
                    <div class="contact-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="contact-text" id="locationText">
                        📍 الموقع
                    </div>
                </div>
            </div>
            <div class="map-container">
                <iframe id="mapFrame" src="https://www.google.com/maps?q=36.484479,32.101147&output=embed" loading="lazy"></iframe>
            </div>
        </div>
    </div>
</section>

<!-- تذييل الصفحة مع اختصارات لوحة المفاتيح -->
<div style="position: fixed; bottom: 10px; left: 10px; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 20px; font-size: 11px; color: #888; backdrop-filter: blur(5px); z-index: 100;">
    <i class="fas fa-keyboard"></i> Ctrl+Z: تراجع | Ctrl+Y: إعادة | Ctrl+F: بحث | Ctrl+S: حفظ | Ctrl+L: لغة | Ctrl+D: سمة
</div>

<script>
    // ===== جميع الدوال في نطاق واحد =====
    (function() {
        // ===== ثوابت =====
        const CLOUD_API_URL = 'https://api.npoint.io/2b9acf08c13ba5b3b27a';
        const DEV_PASS = 'momotunc0702';
        const VIDEO_URL = 'https://www.youtube.com/embed/d6BLnYv_oZE?autoplay=1&mute=0';

        // ===== القائمة الأساسية (يمكن تعديلها بالكامل) =====
        let ORIGINAL_MENU = {
            ar: [
                {
                    category: "أنواع التوست",
                    image: "https://images.unsplash.com/photo-1528735602780-2552fd46c7af?w=400",
                    items: [
                        { name: "توست بالجبن", price: "120₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" },
                        { name: "توست بالسجق", price: "120₺", image: "https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=100" },
                        { name: "مكس جبن وسجق", price: "150₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" },
                        { name: "توست أتوم", price: "200₺", image: "https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=100" }
                    ]
                },
                {
                    category: "مشروبات",
                    image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=400",
                    items: [
                        { name: "شاي", price: "20₺", image: "https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=100" },
                        { name: "قهوة", price: "60₺", image: "https://images.unsplash.com/photo-1461023058943-07fcbe16d735?w=100" },
                        { name: "عيران", price: "20₺", image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=100" }
                    ]
                },
                {
                    category: "حلويات",
                    image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400",
                    items: [
                        { name: "كنافة", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" },
                        { name: "بودنغ الأرز", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" }
                    ]
                }
            ],
            tr: [
                {
                    category: "TOST ÇEŞİTLERİ",
                    image: "https://images.unsplash.com/photo-1528735602780-2552fd46c7af?w=400",
                    items: [
                        { name: "Kaşarlı tost", price: "120₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" },
                        { name: "Sucuklu tost", price: "120₺", image: "https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=100" },
                        { name: "Atom tost", price: "200₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" }
                    ]
                },
                {
                    category: "İÇECEKLER",
                    image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=400",
                    items: [
                        { name: "Çay", price: "20₺", image: "https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=100" },
                        { name: "Türk kahvesi", price: "60₺", image: "https://images.unsplash.com/photo-1461023058943-07fcbe16d735?w=100" },
                        { name: "Ayran", price: "20₺", image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=100" }
                    ]
                },
                {
                    category: "TATLILAR",
                    image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400",
                    items: [
                        { name: "Künefe", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" },
                        { name: "Fırında sütlaç", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" }
                    ]
                }
            ],
            en: [
                {
                    category: "TOAST TYPES",
                    image: "https://images.unsplash.com/photo-1528735602780-2552fd46c7af?w=400",
                    items: [
                        { name: "Cheese toast", price: "120₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" },
                        { name: "Sausage toast", price: "120₺", image: "https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=100" },
                        { name: "Atom toast", price: "200₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" }
                    ]
                },
                {
                    category: "DRINKS",
                    image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=400",
                    items: [
                        { name: "Tea", price: "20₺", image: "https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=100" },
                        { name: "Turkish coffee", price: "60₺", image: "https://images.unsplash.com/photo-1461023058943-07fcbe16d735?w=100" },
                        { name: "Ayran", price: "20₺", image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=100" }
                    ]
                },
                {
                    category: "DESSERTS",
                    image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400",
                    items: [
                        { name: "Kunefe", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" },
                        { name: "Rice pudding", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" }
                    ]
                }
            ],
            ru: [
                {
                    category: "ВИДЫ ТОСТОВ",
                    image: "https://images.unsplash.com/photo-1528735602780-2552fd46c7af?w=400",
                    items: [
                        { name: "Сырный тост", price: "120₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" },
                        { name: "Тост с колбасой", price: "120₺", image: "https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=100" },
                        { name: "Атом тост", price: "200₺", image: "https://images.unsplash.com/photo-1606755456206-b25206cde27e?w=100" }
                    ]
                },
                {
                    category: "НАПИТКИ",
                    image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=400",
                    items: [
                        { name: "Чай", price: "20₺", image: "https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=100" },
                        { name: "Турецкий кофе", price: "60₺", image: "https://images.unsplash.com/photo-1461023058943-07fcbe16d735?w=100" },
                        { name: "Айран", price: "20₺", image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?w=100" }
                    ]
                },
                {
                    category: "ДЕСЕРТЫ",
                    image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400",
                    items: [
                        { name: "Кюнефе", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" },
                        { name: "Рисовый пудинг", price: "120₺", image: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=100" }
                    ]
                }
            ]
        };

        // ===== نصوص الواجهة =====
        const TEXTS = {
            ar: { heroTitle: "توستو", workTime: "🕒 ٠٨:٠٠ - ٠٢:٣٠", viewMenu: "عرض القائمة", menuTitle: "قائمتنا", contactTitle: "اتصل بنا", phone: "٠٥٣٢١٥٨٠٢٠٧", instagram: "إنستغرام", location: "📍 الموقع" },
            tr: { heroTitle: "Tosttoo", workTime: "🕒 08:00 - 02:30", viewMenu: "Menüyü Gör", menuTitle: "Menümüz", contactTitle: "İletişim", phone: "05321580207", instagram: "Instagram", location: "📍 Konum" },
            en: { heroTitle: "Tosttoo", workTime: "🕒 08:00 - 02:30", viewMenu: "View Menu", menuTitle: "Our Menu", contactTitle: "Contact Us", phone: "05321580207", instagram: "Instagram", location: "📍 Location" },
            ru: { heroTitle: "Tosttoo", workTime: "🕒 08:00 - 02:30", viewMenu: "Посмотреть меню", menuTitle: "Наше меню", contactTitle: "Контакты", phone: "05321580207", instagram: "Instagram", location: "📍 Местоположение" }
        };

        // ===== متغيرات الإضافات والصور =====
        let extraCategories = JSON.parse(localStorage.getItem('extraCategories') || '[]');
        let categoryImages = JSON.parse(localStorage.getItem('categoryImages') || '{}');
        let productImages = JSON.parse(localStorage.getItem('productImages') || '{}');
        
        // ===== متغيرات نافذة الصور =====
        let currentImageList = [];
        let currentImageIndex = 0;

        // ===== متغيرات عامة =====
        let isDeveloper = false;
        let deleteMode = false;
        let editMode = false;
        let currentLang = localStorage.getItem('lang') || 'ar';
        let currentVersionType = 'v1';
        let pendingAction = null;
        let teaClickCount = 0;
        let videoShown = false;

        // ===== دوال الفيديو المخفي =====
        window.openVideoModal = function() {
            const modal = document.getElementById('videoModal');
            const frame = document.getElementById('videoFrame');
            const counter = document.getElementById('videoCounter');
            
            frame.src = VIDEO_URL;
            counter.textContent = '🎬 فيديو خاص!';
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        };

        window.closeVideoModal = function() {
            const modal = document.getElementById('videoModal');
            const frame = document.getElementById('videoFrame');
            
            frame.src = '';
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        };

        // إغلاق الفيديو بالضغط على ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                window.closeVideoModal();
            }
        });

        // ===== دوال نافذة الصور (مشتركة) =====
        function openImageGallery(catIdx, catName, currentSrc) {
            const menu = getFullMenu();
            const category = menu[catIdx];
            
            // تجميع جميع الصور في هذا القسم
            const imageList = [];
            
            // إضافة صورة القسم إذا وجدت
            if (categoryImages[catName]) {
                imageList.push({
                    src: categoryImages[catName],
                    title: `📁 ${catName}`
                });
            }
            
            // إضافة صور جميع المنتجات في هذا القسم
            category.items.forEach(item => {
                if (productImages[catIdx] && productImages[catIdx][item.name]) {
                    imageList.push({
                        src: productImages[catIdx][item.name],
                        title: `📦 ${item.name}`
                    });
                }
            });
            
            if (imageList.length === 0) {
                showStatus('لا توجد صور في هذا القسم!', 'error');
                return;
            }
            
            // تحديد الصورة الحالية
            let startIndex = 0;
            if (currentSrc) {
                startIndex = imageList.findIndex(img => img.src === currentSrc);
                if (startIndex === -1) startIndex = 0;
            }
            
            openImageModal(imageList[startIndex].src, imageList[startIndex].title, imageList, startIndex);
        }

        // ===== دوال نافذة تكبير الصور =====
        window.openImageModal = function(src, title, imageList, index) {
            currentImageList = imageList || [];
            currentImageIndex = index || 0;
            
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalInfo = document.getElementById('modalImageInfo');
            const prevBtn = document.querySelector('.image-modal-nav.prev');
            const nextBtn = document.querySelector('.image-modal-nav.next');
            
            modalImg.src = src;
            modalInfo.textContent = title;
            
            if (currentImageList.length > 1) {
                prevBtn.classList.remove('disabled');
                nextBtn.classList.remove('disabled');
                prevBtn.classList.toggle('disabled', index === 0);
                nextBtn.classList.toggle('disabled', index === currentImageList.length - 1);
            } else {
                prevBtn.classList.add('disabled');
                nextBtn.classList.add('disabled');
            }
            
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        };

        window.closeImageModal = function() {
            document.getElementById('imageModal').classList.remove('show');
            document.body.style.overflow = 'auto';
        };

        window.navigateImage = function(direction) {
            const newIndex = currentImageIndex + direction;
            
            if (newIndex >= 0 && newIndex < currentImageList.length) {
                currentImageIndex = newIndex;
                const imgData = currentImageList[newIndex];
                
                const modalImg = document.getElementById('modalImage');
                const modalInfo = document.getElementById('modalImageInfo');
                const prevBtn = document.querySelector('.image-modal-nav.prev');
                const nextBtn = document.querySelector('.image-modal-nav.next');
                
                modalImg.src = imgData.src;
                modalInfo.textContent = imgData.title;
                
                prevBtn.classList.toggle('disabled', newIndex === 0);
                nextBtn.classList.toggle('disabled', newIndex === currentImageList.length - 1);
            }
        };

        // إغلاق النافذة بالضغط على ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                window.closeImageModal();
            }
        });

        // ===== دوال اللغة =====
        window.toggleLanguageMenu = function() {
            const menu = document.getElementById('languageMenu');
            menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
        };

        window.setLanguage = function(lang) {
            currentLang = lang;
            localStorage.setItem('lang', lang);
            const flags = { ar: '🇮🇶', tr: '🇹🇷', en: '🇬🇧', ru: '🇷🇺' };
            document.getElementById('langBtn').textContent = flags[lang];
            document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.getElementById('languageMenu').style.display = 'none';
            
            const t = TEXTS[lang];
            document.getElementById('secretTrigger').textContent = t.heroTitle;
            document.getElementById('workTime').textContent = t.workTime;
            document.getElementById('scrollBtn').textContent = t.viewMenu;
            document.getElementById('menuTitle').innerHTML = `${t.menuTitle} <span class="version-tag">v1.0</span>`;
            document.getElementById('contactTitle').textContent = t.contactTitle;
            document.getElementById('phoneLink').innerHTML = `📞 ${t.phone}`;
            document.getElementById('instaLink').textContent = t.instagram;
            document.getElementById('locationText').innerHTML = t.location;
            
            displayMenu();
            showStatus('تم تغيير اللغة', 'success');
        };

        window.toggleMode = function() {
            document.body.classList.toggle('light-mode');
            document.getElementById('themeToggle').innerHTML = document.body.classList.contains('light-mode') ? '☀️' : '🌙';
            localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
        };

        window.scrollToMenu = function() {
            document.getElementById('menu').scrollIntoView({ behavior: 'smooth' });
        };

        // ===== دوال القائمة =====
        function getFullMenu() {
            const base = ORIGINAL_MENU[currentLang] || ORIGINAL_MENU.ar;
            return [...base, ...extraCategories];
        }

        // دالة حفظ القائمة الكاملة
        function saveFullMenu(menu) {
            // فصل القائمة إلى أساسية وإضافات
            const baseCategories = ORIGINAL_MENU[currentLang] || ORIGINAL_MENU.ar;
            const baseNames = baseCategories.map(c => c.category);
            
            extraCategories = menu.filter(cat => !baseNames.includes(cat.category));
            const newBase = menu.filter(cat => baseNames.includes(cat.category));
            
            // تحديث القائمة الأساسية
            newBase.forEach(newCat => {
                const oldCat = baseCategories.find(c => c.category === newCat.category);
                if (oldCat) {
                    oldCat.items = newCat.items;
                }
            });
            
            localStorage.setItem('extraCategories', JSON.stringify(extraCategories));
        }

        // دوال تفعيل/إلغاء الأوضاع
        window.enableEdit = function() {
            editMode = true;
            deleteMode = false;
            document.getElementById('menuGrid').classList.add('edit-mode');
            document.getElementById('menuGrid').classList.remove('delete-mode');
            showStatus('✏️ وضع التعديل نشط', 'success');
        };

        window.enableDelete = function() {
            deleteMode = true;
            editMode = false;
            document.getElementById('menuGrid').classList.add('delete-mode');
            document.getElementById('menuGrid').classList.remove('edit-mode');
            showStatus('🗑️ وضع الحذف نشط', 'success');
        };

        window.disableAllModes = function() {
            editMode = false;
            deleteMode = false;
            document.getElementById('menuGrid').classList.remove('edit-mode', 'delete-mode');
            showStatus('🔘 تم إلغاء الأوضاع', 'success');
        };

        function displayMenu() {
            const grid = document.getElementById('menuGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            const menu = getFullMenu();
            
            menu.forEach((cat, catIdx) => {
                const card = document.createElement('div');
                card.className = 'card';
                
                // صورة القسم
                if (categoryImages[cat.category] || cat.image) {
                    card.classList.add('has-image');
                    const imgContainer = document.createElement('div');
                    imgContainer.className = 'card-image-container';
                    const img = document.createElement('img');
                    img.src = categoryImages[cat.category] || cat.image;
                    img.className = 'card-image';
                    img.loading = 'lazy';
                    img.onerror = function() { this.src = 'https://via.placeholder.com/400x200?text=صورة'; };
                    img.onclick = (e) => {
                        e.stopPropagation();
                        if (editMode) {
                            const newUrl = prompt('رابط الصورة الجديد:', categoryImages[cat.category] || cat.image || '');
                            if (newUrl) {
                                categoryImages[cat.category] = newUrl;
                                localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
                                displayMenu();
                                showStatus('تم تحديث الصورة', 'success');
                            }
                        } else if (deleteMode) {
                            if (confirm(`حذف صورة "${cat.category}"؟`)) {
                                delete categoryImages[cat.category];
                                localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
                                displayMenu();
                                showStatus('تم حذف الصورة', 'success');
                            }
                        } else {
                            openImageGallery(catIdx, cat.category, categoryImages[cat.category] || cat.image);
                        }
                    };
                    imgContainer.appendChild(img);
                    card.appendChild(imgContainer);
                }
                
                const header = document.createElement('div');
                header.className = 'card-header';
                header.innerHTML = `<h3>${cat.category}</h3>`;
                card.appendChild(header);
                
                const body = document.createElement('div');
                body.className = 'card-body';
                body.innerHTML = '<div class="items-container"></div>';
                const itemsContainer = body.querySelector('.items-container');
                
                cat.items.forEach((item, itemIdx) => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = `item ${(productImages[catIdx] && productImages[catIdx][item.name]) || item.image ? 'has-image' : ''}`;
                    itemDiv.setAttribute('data-category', catIdx);
                    itemDiv.setAttribute('data-item', itemIdx);
                    
                    // صورة المنتج
                    if ((productImages[catIdx] && productImages[catIdx][item.name]) || item.image) {
                        const img = document.createElement('img');
                        img.src = (productImages[catIdx] && productImages[catIdx][item.name]) || item.image;
                        img.className = 'item-image';
                        img.loading = 'lazy';
                        img.onerror = function() { this.src = 'https://via.placeholder.com/60x60?text=صورة'; };
                        img.onclick = (e) => {
                            e.stopPropagation();
                            if (editMode) {
                                const newUrl = prompt('رابط الصورة الجديد:', (productImages[catIdx] && productImages[catIdx][item.name]) || item.image || '');
                                if (newUrl) {
                                    if (!productImages[catIdx]) productImages[catIdx] = {};
                                    productImages[catIdx][item.name] = newUrl;
                                    localStorage.setItem('productImages', JSON.stringify(productImages));
                                    displayMenu();
                                    showStatus('تم تحديث الصورة', 'success');
                                }
                            } else if (deleteMode) {
                                if (confirm(`حذف صورة "${item.name}"؟`)) {
                                    if (productImages[catIdx]) delete productImages[catIdx][item.name];
                                    localStorage.setItem('productImages', JSON.stringify(productImages));
                                    displayMenu();
                                    showStatus('تم حذف الصورة', 'success');
                                }
                            } else {
                                openImageGallery(catIdx, cat.category, (productImages[catIdx] && productImages[catIdx][item.name]) || item.image);
                            }
                        };
                        itemDiv.appendChild(img);
                    }
                    
                    // اسم المنتج
                    const nameSpan = document.createElement('span');
                    nameSpan.className = 'name';
                    nameSpan.textContent = item.name;
                    
                    // 🍵 كود الشاي السري 🍵
                    if (item.name === 'Çay' || item.name === 'شاي' || item.name === 'Tea' || item.name === 'Чай') {
                        nameSpan.onclick = function(e) {
                            e.stopPropagation();
                            if (editMode) {
                                const newName = prompt('الاسم الجديد:', item.name);
                                if (newName) {
                                    updateItemName(catIdx, cat.category, item.name, newName);
                                }
                            } else if (deleteMode) {
                                if (confirm(`حذف "${item.name}"؟`)) {
                                    deleteProduct(catIdx, cat.category, item.name);
                                }
                            } else {
                                teaClickCount++;
                                
                                if (teaClickCount >= 7 && !videoShown) {
                                    videoShown = true;
                                    window.openVideoModal();
                                    teaClickCount = 0;
                                }
                                
                                clearTimeout(window.teaTimer);
                                window.teaTimer = setTimeout(() => {
                                    teaClickCount = 0;
                                }, 5000);
                            }
                        };
                    } else {
                        nameSpan.onclick = (e) => {
                            e.stopPropagation();
                            if (editMode) {
                                const newName = prompt('الاسم الجديد:', item.name);
                                if (newName) {
                                    updateItemName(catIdx, cat.category, item.name, newName);
                                }
                            } else if (deleteMode) {
                                if (confirm(`حذف "${item.name}"؟`)) {
                                    deleteProduct(catIdx, cat.category, item.name);
                                }
                            } else {
                                openImageGallery(catIdx, cat.category, (productImages[catIdx] && productImages[catIdx][item.name]) || item.image);
                            }
                        };
                    }
                    
                    // السعر
                    const priceSpan = document.createElement('span');
                    priceSpan.className = 'price';
                    priceSpan.textContent = item.price;
                    priceSpan.onclick = (e) => {
                        e.stopPropagation();
                        if (editMode) {
                            const newPrice = prompt('السعر الجديد:', item.price);
                            if (newPrice) {
                                updateItemPrice(catIdx, cat.category, item.name, newPrice);
                            }
                        }
                    };
                    
                    // أزرار الإجراءات
                    const actionsDiv = document.createElement('div');
                    actionsDiv.className = 'item-actions';
                    actionsDiv.onclick = (e) => e.stopPropagation();
                    
                    const editBtn = document.createElement('button');
                    editBtn.className = 'item-edit-btn';
                    editBtn.innerHTML = '<i class="fas fa-edit"></i>';
                    editBtn.title = 'تعديل';
                    editBtn.onclick = () => window.editItem(catIdx, itemIdx);
                    
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'item-delete-btn';
                    deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                    deleteBtn.title = 'حذف';
                    deleteBtn.onclick = () => window.deleteItem(catIdx, itemIdx);
                    
                    actionsDiv.appendChild(editBtn);
                    actionsDiv.appendChild(deleteBtn);
                    
                    itemDiv.appendChild(nameSpan);
                    itemDiv.appendChild(priceSpan);
                    itemDiv.appendChild(actionsDiv);
                    itemsContainer.appendChild(itemDiv);
                });
                
                card.appendChild(body);
                
                // زر حذف القسم
                if (isDeveloper && deleteMode) {
                    const deleteCatBtn = document.createElement('button');
                    deleteCatBtn.className = 'delete-card-btn';
                    deleteCatBtn.innerHTML = '<i class="fas fa-times"></i>';
                    deleteCatBtn.title = 'حذف الفئة';
                    deleteCatBtn.onclick = () => {
                        if (confirm(`حذف فئة "${cat.category}" بالكامل؟`)) {
                            deleteCategory(cat.category);
                        }
                    };
                    card.appendChild(deleteCatBtn);
                }
                
                grid.appendChild(card);
            });
            
            updateSelects();
            updateGallery();
        }

        // دالة تحديث اسم المنتج
        function updateItemName(catIdx, catName, oldName, newName) {
            const menu = getFullMenu();
            const category = menu[catIdx];
            const item = category.items.find(i => i.name === oldName);
            
            if (item) {
                item.name = newName;
                
                // تحديث الصورة إذا وجدت
                if (productImages[catIdx] && productImages[catIdx][oldName]) {
                    productImages[catIdx][newName] = productImages[catIdx][oldName];
                    delete productImages[catIdx][oldName];
                    localStorage.setItem('productImages', JSON.stringify(productImages));
                }
                
                saveFullMenu(menu);
                displayMenu();
                showStatus('تم تحديث الاسم', 'success');
            }
        }

        // دالة تحديث سعر المنتج
        function updateItemPrice(catIdx, catName, itemName, newPrice) {
            const menu = getFullMenu();
            const category = menu[catIdx];
            const item = category.items.find(i => i.name === itemName);
            
            if (item) {
                item.price = newPrice;
                saveFullMenu(menu);
                displayMenu();
                showStatus('تم تحديث السعر', 'success');
            }
        }

        // دالة حذف منتج
        function deleteProduct(catIdx, catName, itemName) {
            const menu = getFullMenu();
            const category = menu[catIdx];
            const itemIndex = category.items.findIndex(i => i.name === itemName);
            
            if (itemIndex !== -1) {
                category.items.splice(itemIndex, 1);
                
                // حذف الصورة إذا وجدت
                if (productImages[catIdx] && productImages[catIdx][itemName]) {
                    delete productImages[catIdx][itemName];
                    localStorage.setItem('productImages', JSON.stringify(productImages));
                }
                
                saveFullMenu(menu);
                displayMenu();
                showStatus('تم حذف المنتج', 'success');
            }
        }

        // دالة حذف قسم
        function deleteCategory(catName) {
            const menu = getFullMenu();
            const catIndex = menu.findIndex(c => c.category === catName);
            
            if (catIndex !== -1) {
                menu.splice(catIndex, 1);
                
                // حذف الصور المرتبطة
                if (categoryImages[catName]) {
                    delete categoryImages[catName];
                    localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
                }
                
                saveFullMenu(menu);
                displayMenu();
                showStatus('تم حذف الفئة', 'success');
            }
        }

        // ===== دوال المطور V1 =====
        window.addCategory = function() {
            const name = document.getElementById('newCategory').value.trim();
            if (!name) return showStatus('أدخل اسم الفئة!', 'error');
            
            const menu = getFullMenu();
            menu.push({ category: name, items: [] });
            saveFullMenu(menu);
            
            displayMenu();
            document.getElementById('newCategory').value = '';
            showStatus('تم إضافة الفئة', 'success');
        };

        window.addProduct = function() {
            const name = document.getElementById('newName').value.trim();
            const price = document.getElementById('productPrice').value.trim();
            const idx = document.getElementById('categorySelect').value;
            if (!name || !price) return showStatus('أدخل الاسم والسعر!', 'error');
            
            const menu = getFullMenu();
            const category = menu[idx];
            
            if (category) {
                category.items.push({ name, price });
                saveFullMenu(menu);
                displayMenu();
                document.getElementById('newName').value = '';
                document.getElementById('productPrice').value = '';
                showStatus('تم إضافة المنتج', 'success');
            }
        };

        // ===== دوال المطور V2 =====
        function updateSelects() {
            const menu = getFullMenu();
            const cs = document.getElementById('categorySelect');
            const cis = document.getElementById('categoryImageSelect');
            const pcs = document.getElementById('productCategorySelect');
            
            if (cs) {
                cs.innerHTML = '';
                menu.forEach((c, i) => cs.innerHTML += `<option value="${i}">${c.category}</option>`);
            }
            if (cis) {
                cis.innerHTML = '<option value="">اختر الفئة</option>';
                menu.forEach(c => cis.innerHTML += `<option value="${c.category}">${c.category}</option>`);
            }
            if (pcs) {
                pcs.innerHTML = '<option value="">اختر الفئة</option>';
                menu.forEach((c, i) => pcs.innerHTML += `<option value="${i}">${c.category}</option>`);
            }
        }

        window.previewCategoryImage = function() {
            const url = document.getElementById('categoryImageUrl').value;
            const preview = document.getElementById('categoryImagePreview');
            preview.innerHTML = url ? `<img src="${url}" onerror="this.src='https://via.placeholder.com/150?text=خطأ'">` : '<span>معاينة الصورة</span>';
        };

        window.previewProductImage = function() {
            const url = document.getElementById('productImageUrl').value;
            const preview = document.getElementById('productImagePreview');
            preview.innerHTML = url ? `<img src="${url}" onerror="this.src='https://via.placeholder.com/150?text=خطأ'">` : '<span>معاينة الصورة</span>';
        };

        window.addCategoryImage = function() {
            const cat = document.getElementById('categoryImageSelect').value;
            const url = document.getElementById('categoryImageUrl').value;
            if (!cat || !url) return showStatus('اختر الفئة وأدخل الرابط!', 'error');
            categoryImages[cat] = url;
            localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
            displayMenu();
            updateGallery();
            showStatus('تم إضافة صورة الفئة', 'success');
        };

        window.deleteCategoryImage = function() {
            const cat = document.getElementById('categoryImageSelect').value;
            if (!cat || !categoryImages[cat]) return showStatus('اختر فئة بها صورة!', 'error');
            delete categoryImages[cat];
            localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
            displayMenu();
            updateGallery();
            showStatus('تم حذف صورة الفئة', 'success');
        };

        window.addProductImage = function() {
            const catIdx = document.getElementById('productCategorySelect').value;
            const prodIdx = document.getElementById('productSelect').value;
            const url = document.getElementById('productImageUrl').value;
            if (!catIdx || !prodIdx || !url) return showStatus('اختر الفئة والمنتج وأدخل الرابط!', 'error');
            
            const menu = getFullMenu();
            const prod = menu[catIdx].items[prodIdx].name;
            
            if (!productImages[catIdx]) productImages[catIdx] = {};
            productImages[catIdx][prod] = url;
            localStorage.setItem('productImages', JSON.stringify(productImages));
            displayMenu();
            updateGallery();
            showStatus('تم إضافة صورة المنتج', 'success');
        };

        window.deleteProductImage = function() {
            const catIdx = document.getElementById('productCategorySelect').value;
            const prodIdx = document.getElementById('productSelect').value;
            if (!catIdx || !prodIdx) return showStatus('اختر الفئة والمنتج!', 'error');
            
            const menu = getFullMenu();
            const prod = menu[catIdx].items[prodIdx].name;
            
            if (productImages[catIdx] && productImages[catIdx][prod]) {
                delete productImages[catIdx][prod];
                localStorage.setItem('productImages', JSON.stringify(productImages));
                displayMenu();
                updateGallery();
                showStatus('تم حذف صورة المنتج', 'success');
            }
        };

        function updateGallery() {
            const gallery = document.getElementById('imageGallery');
            if (!gallery) return;
            let html = '';
            
            Object.keys(categoryImages).forEach(c => {
                html += `<div class="category-with-image" onclick="deleteCategoryImageByName('${c}')">
                    <img src="${categoryImages[c]}"><span>📁 ${c}</span>
                </div>`;
            });
            
            Object.keys(productImages).forEach(ci => {
                Object.keys(productImages[ci]).forEach(p => {
                    html += `<div class="product-with-image" onclick="deleteProductImageByName('${ci}', '${p}')">
                        <img src="${productImages[ci][p]}"><span>📦 ${p}</span>
                    </div>`;
                });
            });
            
            gallery.innerHTML = html || '<p class="text-center">لا توجد صور</p>';
        }

        window.deleteCategoryImageByName = function(c) {
            if (confirm(`حذف صورة "${c}"؟`)) {
                delete categoryImages[c];
                localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
                displayMenu();
                updateGallery();
                showStatus('تم حذف الصورة', 'success');
            }
        };

        window.deleteProductImageByName = function(ci, p) {
            if (confirm(`حذف صورة "${p}"؟`)) {
                delete productImages[ci][p];
                localStorage.setItem('productImages', JSON.stringify(productImages));
                displayMenu();
                updateGallery();
                showStatus('تم حذف الصورة', 'success');
            }
        };

        window.deleteAllCategoryImages = function() {
            if (!confirm('حذف جميع صور الفئات؟')) return;
            categoryImages = {};
            localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
            displayMenu();
            updateGallery();
            showStatus('تم حذف صور الفئات', 'success');
        };

        window.deleteAllProductImages = function() {
            if (!confirm('حذف جميع صور المنتجات؟')) return;
            productImages = {};
            localStorage.setItem('productImages', JSON.stringify(productImages));
            displayMenu();
            updateGallery();
            showStatus('تم حذف صور المنتجات', 'success');
        };

        window.deleteAllImages = function() {
            if (!confirm('حذف جميع الصور؟')) return;
            categoryImages = {};
            productImages = {};
            localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
            localStorage.setItem('productImages', JSON.stringify(productImages));
            displayMenu();
            updateGallery();
            showStatus('تم حذف جميع الصور', 'success');
        };

        document.getElementById('productCategorySelect')?.addEventListener('change', function() {
            const ci = this.value;
            const ps = document.getElementById('productSelect');
            if (!ci) { 
                ps.disabled = true; 
                ps.innerHTML = '<option>اختر الفئة أولاً</option>'; 
                return; 
            }
            const menu = getFullMenu();
            ps.disabled = false;
            ps.innerHTML = '<option value="">اختر المنتج</option>';
            menu[ci].items.forEach((it, i) => ps.innerHTML += `<option value="${i}">${it.name}</option>`);
        });

        // ===== دوال المطور العامة =====
        window.selectDevVersion = function(v) {
            closeVersionModal();
            isDeveloper = true;
            document.getElementById('floatingDevBtn').style.display = 'flex';
            document.getElementById(`devPanel${v.toUpperCase()}`).style.display = 'block';
            displayMenu();
            updateSelects();
            updateGallery();
        };

        window.closeDevV1 = function() {
            document.getElementById('devPanelV1').style.display = 'none';
            document.getElementById('floatingDevBtn').style.display = 'flex';
            isDeveloper = false;
            editMode = false;
            deleteMode = false;
            document.getElementById('menuGrid').classList.remove('edit-mode', 'delete-mode');
            displayMenu();
        };

        window.closeDevV2 = function() {
            document.getElementById('devPanelV2').style.display = 'none';
            document.getElementById('floatingDevBtn').style.display = 'flex';
            isDeveloper = false;
            editMode = false;
            deleteMode = false;
            document.getElementById('menuGrid').classList.remove('edit-mode', 'delete-mode');
            displayMenu();
        };

        window.toggleDevPanel = function() {
            const p = document.getElementById(`devPanel${currentVersionType.toUpperCase()}`);
            if (p.style.display === 'block') {
                p.style.display = 'none';
                document.getElementById('floatingDevBtn').style.display = 'flex';
                editMode = false;
                deleteMode = false;
                document.getElementById('menuGrid').classList.remove('edit-mode', 'delete-mode');
            } else {
                p.style.display = 'block';
                document.getElementById('floatingDevBtn').style.display = 'none';
                updateSelects();
                updateGallery();
            }
        };

        window.closeVersionModal = function() {
            document.getElementById('devVersionModal').style.display = 'none';
        };

        window.resetToOriginal = function() {
            if (!confirm('إعادة تعيين القائمة؟ (سيتم حذف جميع الإضافات والصور)')) return;
            extraCategories = [];
            categoryImages = {};
            productImages = {};
            localStorage.setItem('extraCategories', JSON.stringify(extraCategories));
            localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
            localStorage.setItem('productImages', JSON.stringify(productImages));
            displayMenu();
            updateGallery();
            showStatus('تم إعادة تعيين القائمة', 'success');
        };

        window.changeInstagram = function() {
            const v = document.getElementById('newInstagram').value;
            if (v) { 
                document.getElementById('instaLink').href = v; 
                localStorage.setItem('insta', v); 
                showStatus('تم تحديث رابط إنستغرام', 'success'); 
            }
        };

        window.changeLocation = function() {
            const v = document.getElementById('newLocation').value;
            if (v) { 
                document.getElementById('mapFrame').src = `https://www.google.com/maps?q=${v}&output=embed`; 
                localStorage.setItem('map', v); 
                showStatus('تم تحديث الموقع', 'success'); 
            }
        };

        window.openColorPicker = function() { 
            document.getElementById('colorPickerModal').style.display = 'flex'; 
        };
        
        window.closeColorPicker = function() { 
            document.getElementById('colorPickerModal').style.display = 'none'; 
        };
        
        window.applyColors = function() {
            const catColor = document.getElementById('colorCategory').value;
            const nameColor = document.getElementById('colorName').value;
            const priceColor = document.getElementById('colorPrice').value;
            
            document.documentElement.style.setProperty('--primary', catColor);
            
            const style = document.createElement('style');
            style.id = 'customColors';
            style.textContent = `
                .item-name { color: ${nameColor} !important; }
                .item-price { 
                    color: ${priceColor} !important; 
                    background: ${catColor}20 !important;
                    border-color: ${catColor} !important;
                }
                .card-header h3 { color: ${catColor} !important; }
                .section-title { color: ${catColor} !important; }
            `;
            
            const oldStyle = document.getElementById('customColors');
            if (oldStyle) oldStyle.remove();
            document.head.appendChild(style);
            
            closeColorPicker();
            showStatus('تم تطبيق الألوان', 'success');
        };

        window.copyV1Code = function() {
            const code = JSON.stringify(getFullMenu(), null, 2);
            navigator.clipboard.writeText(code);
            showStatus('📋 تم نسخ الكود', 'success');
        };

        window.copyBackupCode = function() {
            const data = { menu: getFullMenu(), images: { categories: categoryImages, products: productImages } };
            navigator.clipboard.writeText(JSON.stringify(data, null, 2));
            showStatus('📋 تم نسخ الكود', 'success');
        };

        window.pasteBackupCode = function() {
            const code = prompt('الصق الكود هنا:');
            if (!code) return;
            try {
                const data = JSON.parse(code);
                if (data.menu) {
                    const base = ORIGINAL_MENU[currentLang] || ORIGINAL_MENU.ar;
                    extraCategories = data.menu.filter(item => !base.some(b => b.category === item.category));
                    localStorage.setItem('extraCategories', JSON.stringify(extraCategories));
                    
                    if (data.images) {
                        if (data.images.categories) {
                            categoryImages = data.images.categories;
                            localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
                        }
                        if (data.images.products) {
                            productImages = data.images.products;
                            localStorage.setItem('productImages', JSON.stringify(productImages));
                        }
                    }
                    
                    displayMenu();
                    updateGallery();
                    showStatus('✅ تم تحميل الكود', 'success');
                }
            } catch (e) {
                showStatus('❌ كود غير صالح', 'error');
            }
        };

        window.saveToCloud = async function() {
            showStatus('☁️ جاري الحفظ...', 'loading');
            document.getElementById('cloudSaveBtn').disabled = true;
            try {
                await fetch(CLOUD_API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        menu: getFullMenu(),
                        images: { categories: categoryImages, products: productImages }
                    })
                });
                document.getElementById('lastCloudSave').innerHTML = new Date().toLocaleTimeString('ar');
                showStatus('✅ تم الحفظ في السحابة', 'success');
            } catch (e) {
                showStatus('❌ خطأ في الاتصال', 'error');
            }
            document.getElementById('cloudSaveBtn').disabled = false;
        };

        window.loadFromCloud = async function() {
            showStatus('📥 جاري التحميل...', 'loading');
            document.getElementById('cloudLoadBtn').disabled = true;
            try {
                const res = await fetch(CLOUD_API_URL);
                const data = await res.json();
                if (data.menu) {
                    const base = ORIGINAL_MENU[currentLang] || ORIGINAL_MENU.ar;
                    extraCategories = data.menu.filter(item => !base.some(b => b.category === item.category));
                    localStorage.setItem('extraCategories', JSON.stringify(extraCategories));
                    
                    if (data.images) {
                        if (data.images.categories) {
                            categoryImages = data.images.categories;
                            localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
                        }
                        if (data.images.products) {
                            productImages = data.images.products;
                            localStorage.setItem('productImages', JSON.stringify(productImages));
                        }
                    }
                    
                    displayMenu();
                    updateGallery();
                    showStatus('✅ تم التحميل من السحابة', 'success');
                }
            } catch (e) {
                showStatus('❌ خطأ في التحميل', 'error');
            }
            document.getElementById('cloudLoadBtn').disabled = false;
        };

        window.testCloudConnection = async function() {
            try {
                await fetch(CLOUD_API_URL);
                document.getElementById('apiStatus').innerHTML = 'متصل';
                document.getElementById('apiStatus').style.color = '#00ff00';
                showStatus('✅ اتصال ناجح', 'success');
            } catch {
                document.getElementById('apiStatus').innerHTML = 'غير متصل';
                document.getElementById('apiStatus').style.color = '#ff0000';
                showStatus('❌ فشل الاتصال', 'error');
            }
        };

        window.saveImagesToCloud = function() {
            localStorage.setItem('cloudImagesBackup', JSON.stringify({ categories: categoryImages, products: productImages }));
            showStatus('✅ تم حفظ الصور محلياً', 'success');
        };

        window.loadImagesFromCloud = function() {
            const b = localStorage.getItem('cloudImagesBackup');
            if (b) {
                const d = JSON.parse(b);
                categoryImages = d.categories || {};
                productImages = d.products || {};
                localStorage.setItem('categoryImages', JSON.stringify(categoryImages));
                localStorage.setItem('productImages', JSON.stringify(productImages));
                displayMenu();
                updateGallery();
                showStatus('✅ تم تحميل الصور', 'success');
            }
        };

        function showStatus(message, type) {
            const old = document.querySelector('.status-message');
            if (old) old.remove();
            
            const status = document.createElement('div');
            status.className = `status-message status-${type}`;
            status.innerHTML = `
                <div class="toast-icon"><i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}-circle"></i></div>
                <div class="toast-message">${message}</div>
                <div class="toast-close" onclick="this.parentElement.remove()"><i class="fas fa-times"></i></div>
            `;
            document.body.appendChild(status);
            setTimeout(() => status.remove(), 3000);
        }

        // ===== دوال التعديل والحذف =====
        window.editItem = function(catIdx, itemIdx) {
            const menu = getFullMenu();
            const item = menu[catIdx].items[itemIdx];
            
            const newName = prompt('الاسم الجديد:', item.name);
            if (newName) {
                const newPrice = prompt('السعر الجديد:', item.price);
                if (newPrice) {
                    updateItemName(catIdx, menu[catIdx].category, item.name, newName);
                    updateItemPrice(catIdx, menu[catIdx].category, newName, newPrice);
                }
            }
        };

        window.deleteItem = function(catIdx, itemIdx) {
            const menu = getFullMenu();
            const item = menu[catIdx].items[itemIdx];
            
            if (confirm(`حذف "${item.name}"؟`)) {
                deleteProduct(catIdx, menu[catIdx].category, item.name);
            }
        };

        // ===== دخول المطور =====
        let clickCount = 0;
        document.getElementById('secretTrigger').addEventListener('click', function() {
            clickCount++;
            setTimeout(() => clickCount = 0, 3000);
            if (clickCount === 7) {
                const p = prompt('كلمة المرور:');
                if (p === DEV_PASS) {
                    document.getElementById('devVersionModal').style.display = 'flex';
                    showStatus('مرحباً أيها المطور', 'success');
                } else {
                    showStatus('❌ كلمة مرور خاطئة', 'error');
                }
                clickCount = 0;
            }
        });

        document.addEventListener('keydown', e => {
            if (e.key === 'F5') {
                e.preventDefault();
                const p = prompt('كلمة المرور:');
                if (p === DEV_PASS) {
                    document.getElementById('devVersionModal').style.display = 'flex';
                } else {
                    showStatus('❌ كلمة مرور خاطئة', 'error');
                }
            }
        });

        // ===== تحميل الصفحة =====
        document.addEventListener('DOMContentLoaded', function() {
            const savedLang = localStorage.getItem('lang') || 'ar';
            setLanguage(savedLang);
            
            if (localStorage.getItem('theme') === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('themeToggle').innerHTML = '☀️';
            }
            
            ['colorCategory', 'colorName', 'colorPrice'].forEach(id => {
                const v = localStorage.getItem(id);
                if (v) document.getElementById(id).value = v;
            });
            
            const insta = localStorage.getItem('insta');
            if (insta) document.getElementById('instaLink').href = insta;
            
            const map = localStorage.getItem('map');
            if (map) document.getElementById('mapFrame').src = `https://www.google.com/maps?q=${map}&output=embed`;
            
            displayMenu();
            
            document.addEventListener('click', function(e) {
                const btn = document.getElementById('langBtn');
                const menu = document.getElementById('languageMenu');
                if (!btn.contains(e.target) && !menu.contains(e.target)) {
                    menu.style.display = 'none';
                }
            });
        });

        // سحب لوحة V1
        const devPanelV1 = document.getElementById('devPanelV1');
        let isDragging = false;
        let offsetX, offsetY;
        const dragHandle = document.getElementById('dragHandle');

        if (dragHandle) {
            dragHandle.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        function startDrag(e) {
            if (e.target.closest('button')) return;
            isDragging = true;
            offsetX = e.clientX - devPanelV1.offsetLeft;
            offsetY = e.clientY - devPanelV1.offsetTop;
            devPanelV1.style.transform = 'none';
            devPanelV1.style.cursor = 'grabbing';
        }

        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            devPanelV1.style.left = (e.clientX - offsetX) + 'px';
            devPanelV1.style.top = (e.clientY - offsetY) + 'px';
        }

        function stopDrag() {
            isDragging = false;
            devPanelV1.style.cursor = 'move';
        }

        // منع القائمة اليمنى
        document.addEventListener('contextmenu', (e) => {
            if (!e.target.closest('.dev-window') && !e.target.closest('.modal')) {
                e.preventDefault();
            }
        });
    })();
</script>
</body>
</html>
