<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<title>Tosttoo | CanlÄ± MenÃ¼</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
    color: #fff;
    min-height: 100vh;
}

/* ===== Ø§Ù„Ù‡ÙŠØ±Ùˆ ===== */
.hero {
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    position: relative;
    background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), 
                url('https://i.postimg.cc/k5TwQCVb/hero.jpg');
    background-size: cover;
    background-position: center;
}

.hero h1 {
    font-size: clamp(40px, 15vw, 80px);
    color: #ff8c00;
    margin: 0;
    cursor: pointer;
    text-shadow: 0 0 20px rgba(255,140,0,0.5);
    user-select: none;
}

.work-time {
    font-size: clamp(16px, 4vw, 20px);
    margin: 15px 0;
    padding: 8px 20px;
    background: rgba(0,0,0,0.6);
    border-radius: 30px;
    border: 1px solid #ff8c00;
    backdrop-filter: blur(5px);
}

.price-container {
    margin: 15px 0;
    font-size: clamp(20px, 5vw, 28px);
    background: rgba(0,0,0,0.7);
    padding: 12px 25px;
    border-radius: 50px;
    border: 1px solid #ff8c00;
    backdrop-filter: blur(5px);
}

#price {
    color: #ff8c00;
    font-weight: bold;
    font-size: clamp(24px, 6vw, 32px);
}

.btn {
    background: #ff8c00;
    border: none;
    padding: 12px 30px;
    color: #fff;
    font-size: clamp(16px, 4vw, 18px);
    font-weight: 600;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin: 10px;
}

.btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(255,140,0,0.5);
}

/* ===== Ø§Ù„Ù…Ù†ÙŠÙˆ ===== */
.container {
    padding: 40px 15px;
    max-width: 1200px;
    margin: 0 auto;
}

.container h2 {
    font-size: clamp(30px, 8vw, 40px);
    color: #ff8c00;
    text-align: center;
    margin-bottom: 30px;
}

.card {
    background: rgba(30, 30, 30, 0.9);
    backdrop-filter: blur(10px);
    padding: 20px;
    border-radius: 20px;
    margin: 20px 0;
    border: 1px solid rgba(255,140,0,0.3);
    position: relative;
    transition: all 0.3s ease;
}

.card:hover {
    border-color: #ff8c00;
    transform: translateY(-3px);
}

.card h3 {
    color: #ff8c00;
    font-size: clamp(22px, 6vw, 28px);
    margin-bottom: 15px;
    text-align: center;
    border-bottom: 2px solid #ff8c00;
    padding-bottom: 10px;
    padding-right: 40px;
}

/* ===== Ø²Ø± Ø­Ø°Ù Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ===== */
.delete-card-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: #dc3545;
    color: #fff;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    opacity: 0;
    box-shadow: 0 2px 10px rgba(220,53,69,0.3);
    z-index: 10;
}

.card:hover .delete-card-btn {
    opacity: 1;
}

@media (max-width: 768px) {
    .delete-card-btn {
        display: none;
    }
}

.item {
    display: flex;
    justify-content: space-between;
    margin: 10px 0;
    padding: 8px 15px;
    background: rgba(0,0,0,0.4);
    border-radius: 10px;
    transition: all 0.3s ease;
    position: relative;
}

.name {
    color: #ff8c00;
    font-weight: 600;
    font-size: clamp(14px, 4vw, 16px);
}

.item-price {
    color: #fff;
    font-weight: bold;
    font-size: clamp(14px, 4vw, 16px);
}

/* ===== Ø§Ù„Ø§ØªØµØ§Ù„ ===== */
.contact {
    text-align: center;
    padding: 40px 15px;
    background: linear-gradient(to top, #000, #1a1a1a);
    margin-top: 30px;
}

.contact h2 {
    font-size: clamp(30px, 8vw, 40px);
    color: #ff8c00;
    margin-bottom: 20px;
}

.contact a {
    color: #ff8c00;
    text-decoration: none;
    word-break: break-word;
}

iframe {
    border-radius: 15px;
    margin-top: 20px;
    border: 3px solid #ff8c00;
    max-width: 100%;
    height: 250px;
}

/* ===== Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø·ÙˆØ± ===== */
@media (max-width: 768px) {
    .dev-panel {
        display: none !important;
    }
}

.dev-panel {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 500px;
    max-height: 80vh;
    overflow-y: auto;
    background: rgba(20, 20, 20, 0.95);
    backdrop-filter: blur(15px);
    padding: 20px;
    border: 2px solid #ff8c00;
    border-radius: 20px;
    z-index: 2000;
    display: none;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    cursor: move;
    user-select: none;
}

.dev-panel.open {
    display: block;
}

.dev-panel-header {
    padding: 5px 10px 15px 10px;
    cursor: move;
    border-bottom: 1px solid rgba(255, 140, 0, 0.3);
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.dev-panel-header h3 {
    color: #ff8c00;
    font-size: 24px;
    margin: 0;
}

.drag-indicator {
    color: rgba(255, 140, 0, 0.7);
    font-size: 20px;
}

.dev-section {
    margin: 15px 0;
    padding: 15px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 12px;
    border: 1px solid rgba(255, 140, 0, 0.3);
}

.dev-section h4 {
    color: #ff8c00;
    margin-bottom: 10px;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.dev-panel input,
.dev-panel select {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    background: rgba(0, 0, 0, 0.7);
    border: 1px solid rgba(255, 140, 0, 0.3);
    color: #fff;
    border-radius: 8px;
    font-family: 'Poppins', sans-serif;
    font-size: 14px;
}

.dev-panel button {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    background: #ff8c00;
    border: none;
    color: #fff;
    font-weight: 600;
    border-radius: 8px;
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
    font-size: 14px;
    transition: all 0.3s ease;
}

.dev-panel button:hover {
    background: #ffa233;
    transform: translateY(-2px);
}

.dev-panel .save-btn {
    background: #28a745;
}

.dev-panel .delete-btn {
    background: #dc3545;
}

.dev-panel .close-btn {
    background: #6c757d;
    margin-top: 15px;
}

/* ===== Ù‚Ø³Ù… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† ===== */
.color-section {
    background: rgba(255, 140, 0, 0.15);
    border: 2px solid #ff8c00;
}

.color-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 10px 0;
}

.color-row label {
    flex: 1;
    font-size: 14px;
}

.color-row input[type="color"] {
    width: 60px;
    height: 40px;
    padding: 2px;
    border: 2px solid #ff8c00;
    border-radius: 8px;
    cursor: pointer;
}

/* ===== Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ===== */
.live-badge {
    position: fixed;
    top: 20px;
    left: 20px;
    background: rgba(255, 0, 0, 0.8);
    color: #fff;
    padding: 5px 15px;
    border-radius: 30px;
    font-size: 12px;
    font-weight: bold;
    animation: pulse 1.5s infinite;
    z-index: 100;
}

@keyframes pulse {
    0% { opacity: 0.5; }
    50% { opacity: 1; }
    100% { opacity: 0.5; }
}

/* ===== Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© ===== */
.status-message {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 12px 20px;
    border-radius: 10px;
    background: rgba(0,0,0,0.9);
    border: 2px solid;
    color: #fff;
    font-weight: 600;
    z-index: 3000;
    animation: slideIn 0.3s ease;
    font-size: 14px;
    max-width: 90%;
}

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

.status-success { border-color: #28a745; }
.status-error { border-color: #dc3545; }
.status-loading { border-color: #ff8c00; }

/* ===== Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ===== */
.delete-mode .item {
    cursor: pointer;
    position: relative;
}

.delete-mode .item:hover {
    background: rgba(255,0,0,0.2);
    border: 1px solid red;
}

.edit-mode .item-price {
    background: rgba(255,140,0,0.2);
    padding: 2px 8px;
    border-radius: 5px;
    cursor: text;
}

/* ===== ØªÙ„Ù…ÙŠØ­ ===== */
.f5-hint {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: rgba(255,140,0,0.2);
    border: 1px solid #ff8c00;
    padding: 8px 15px;
    border-radius: 30px;
    font-size: 12px;
    color: #ff8c00;
    backdrop-filter: blur(5px);
    z-index: 100;
    pointer-events: none;
}

@media (max-width: 768px) {
    .f5-hint, .live-badge {
        display: none;
    }
}
</style>
</head>

<body>

<!-- Ø´Ø§Ø±Ø© Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± -->
<div class="live-badge">ğŸ”´ CANLI</div>

<!-- ØªÙ„Ù…ÙŠØ­ -->
<div class="f5-hint">ğŸ’» Ctrl+F5 - GeliÅŸtirici Paneli</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø·ÙˆØ± -->
<div class="dev-panel" id="devPanel">
    <div class="dev-panel-header" id="panelHeader">
        <h3>âš™ï¸ GeliÅŸtirici Paneli</h3>
        <div class="drag-indicator">â‹®â‹®</div>
    </div>
    
    <!-- ÃœrÃ¼n Ekle -->
    <div class="dev-section">
        <h4>â• ÃœrÃ¼n Ekle</h4>
        <select id="categorySelect"></select>
        <input type="text" id="productName" placeholder="ÃœrÃ¼n adÄ±">
        <input type="text" id="productPrice" placeholder="Fiyat">
        <button onclick="addProduct()" class="save-btn">âœ… ÃœrÃ¼n Ekle</button>
    </div>
    
    <!-- Kategori Ekle -->
    <div class="dev-section">
        <h4>ğŸ“ Kategori Ekle</h4>
        <input type="text" id="newCategory" placeholder="Yeni kategori adÄ±">
        <button onclick="addCategory()" class="save-btn">ğŸ“ Kategori Ekle</button>
    </div>
    
    <!-- Renk DÃ¼zenle -->
    <div class="dev-section color-section">
        <h4>ğŸ¨ Renkleri DÃ¼zenle</h4>
        
        <div class="color-row">
            <label>Kategori BaÅŸlÄ±ÄŸÄ±</label>
            <input type="color" id="colorCategory" value="#ff8c00">
        </div>
        
        <div class="color-row">
            <label>ÃœrÃ¼n AdÄ±</label>
            <input type="color" id="colorName" value="#ff8c00">
        </div>
        
        <div class="color-row">
            <label>Fiyat</label>
            <input type="color" id="colorPrice" value="#ffffff">
        </div>
        
        <div class="color-row">
            <label>Buton Rengi</label>
            <input type="color" id="colorButton" value="#ff8c00">
        </div>
        
        <button onclick="applyColors()" class="save-btn">ğŸ¨ Renkleri Uygula</button>
        <button onclick="resetColors()">ğŸ”„ SÄ±fÄ±rla</button>
    </div>
    
    <!-- AraÃ§lar -->
    <div class="dev-section">
        <h4>ğŸ”§ AraÃ§lar</h4>
        <button onclick="toggleDeleteMode()">ğŸ—‘ï¸ Silme Modu</button>
        <button onclick="toggleEditMode()">âœï¸ DÃ¼zenleme Modu</button>
        <button onclick="updateInstagram()">ğŸ“· Instagram GÃ¼ncelle</button>
        <button onclick="updateLocation()">ğŸ“ Konum GÃ¼ncelle</button>
    </div>
    
    <!-- Supabase + CanlÄ± YayÄ±n -->
    <div class="dev-section">
        <h4>ğŸ“¡ CanlÄ± YayÄ±n</h4>
        <button onclick="saveAndBroadcast()" class="save-btn" style="background: #0066cc;">
            ğŸŒ Herkese GÃ¶nder
        </button>
        <div style="font-size:12px; color:#aaa; text-align:center;">
            TÃ¼m deÄŸiÅŸiklikler anÄ±nda herkese ulaÅŸÄ±r
        </div>
    </div>
    
    <button onclick="closeDevPanel()" class="close-btn">âŒ Kapat</button>
</div>

<!-- Ana Ä°Ã§erik -->
<div class="main-content">
    <section class="hero">
        <h1 id="logo">Tosttoo</h1>
        <div class="work-time">ğŸ•’ 08:00 - 02:30</div>
        <div class="price-container">
            ğŸ’° Fiyat: <span id="price">60â‚º</span>
        </div>
        <button class="btn" onclick="scrollToMenu()">MenÃ¼yÃ¼ GÃ¶r</button>
    </section>

    <div class="container" id="menu">
        <h2>ğŸ½ï¸ MenÃ¼</h2>
        
        <div class="card">
            <h3>ğŸ¥ª Tostlar</h3>
            <button class="delete-card-btn" onclick="deleteCard(this)">âœ•</button>
            <div class="item"><span class="name">KaÅŸarlÄ± Tost</span><span class="item-price">60â‚º</span></div>
            <div class="item"><span class="name">Sucuklu Tost</span><span class="item-price">75â‚º</span></div>
            <div class="item"><span class="name">KarÄ±ÅŸÄ±k Tost</span><span class="item-price">85â‚º</span></div>
        </div>
        
        <div class="card">
            <h3>ğŸ¥¤ Ä°Ã§ecekler</h3>
            <button class="delete-card-btn" onclick="deleteCard(this)">âœ•</button>
            <div class="item"><span class="name">Ã‡ay</span><span class="item-price">10â‚º</span></div>
            <div class="item"><span class="name">Kahve</span><span class="item-price">15â‚º</span></div>
            <div class="item"><span class="name">Meyve Suyu</span><span class="item-price">20â‚º</span></div>
        </div>
        
        <div class="card">
            <h3>ğŸ° TatlÄ±lar</h3>
            <button class="delete-card-btn" onclick="deleteCard(this)">âœ•</button>
            <div class="item"><span class="name">KÃ¼nefe</span><span class="item-price">50â‚º</span></div>
            <div class="item"><span class="name">Baklava</span><span class="item-price">45â‚º</span></div>
            <div class="item"><span class="name">SÃ¼tlaÃ§</span><span class="item-price">30â‚º</span></div>
        </div>
    </div>

    <section class="contact">
        <h2>ğŸ“ Ä°letiÅŸim</h2>
        <p>ğŸ“ <a href="tel:05321580207">0532 158 0207</a></p>
        <p>ğŸ“· <a id="instaLink" href="https://www.instagram.com/tosttooyevski/" target="_blank">Instagram</a></p>
        <div class="map-container">
            <iframe id="mapFrame" src="https://www.google.com/maps?q=36.484479,32.101147&output=embed" width="100%" height="250" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </section>
</div>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
// ===== SUPABASE =====
const supabaseUrl = "https://cufbyiefzbgygtyibupl.supabase.co";
const supabaseKey = "sb_publishable_mTI9Fl-eMcN3TbLqyQAGNw_fzQF7ssr";
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

// ===== CANLI YAYIN KANALI =====
const broadcastChannel = supabase.channel('menu-updates', {
    config: { broadcast: { self: true } }
});

// CanlÄ± yayÄ±nÄ± dinle
broadcastChannel
    .on('broadcast', { event: 'menu-changed' }, (payload) => {
        console.log('ğŸ”„ CanlÄ± gÃ¼ncelleme:', payload);
        
        if (payload.payload.type === 'menu') {
            document.getElementById('menu').innerHTML = payload.payload.data;
            updateCategorySelect();
            showStatus('ğŸ“‹ MenÃ¼ gÃ¼ncellendi!', 'success');
        }
        
        if (payload.payload.type === 'instagram') {
            document.getElementById('instaLink').href = payload.payload.data;
        }
        
        if (payload.payload.type === 'location') {
            document.getElementById('mapFrame').src = payload.payload.data;
        }
        
        if (payload.payload.type === 'colors') {
            applyColorsFromData(payload.payload.data);
        }
    })
    .subscribe();

// ===== DEÄÄ°ÅKENLER =====
let deleteMode = false;
let editMode = false;
let clickCount = 0;
let ctrlPressed = false;

// VarsayÄ±lan renkler
const defaultColors = {
    category: '#ff8c00',
    name: '#ff8c00',
    price: '#ffffff',
    button: '#ff8c00'
};

// ===== CÄ°HAZ KONTROLÃœ =====
function isMobile() {
    return window.innerWidth <= 768;
}

// ===== TEMEL =====
function scrollToMenu() {
    document.getElementById("menu").scrollIntoView({behavior: "smooth"});
}

// ===== CTRL TAKÄ°BÄ° =====
document.addEventListener('keydown', e => { if(e.key === 'Control') ctrlPressed = true; });
document.addEventListener('keyup', e => { if(e.key === 'Control') ctrlPressed = false; });

// ===== GÄ°RÄ°Å =====
document.getElementById("logo").addEventListener("click", function() {
    if(isMobile()) return;
    
    clickCount++;
    setTimeout(() => clickCount = 0, 3000);
    
    if(clickCount === 5) {
        let pass = prompt("ğŸ” Åifre:");
        if(pass === "momotunc0702") {
            openDevPanel();
            showStatus("âœ… HoÅŸ geldiniz!", "success");
        }
    }
});

document.addEventListener('keydown', function(e) {
    if(isMobile()) return;
    if(e.key === 'F5' && ctrlPressed) {
        e.preventDefault();
        let pass = prompt("ğŸ” Åifre (Ctrl+F5):");
        if(pass === "momotunc0702") {
            openDevPanel();
            showStatus("âœ… HoÅŸ geldiniz!", "success");
        }
    }
});

// ===== SÃœRÃœKLEME =====
let isDragging = false, xOffset = 0, yOffset = 0;
const panel = document.getElementById('devPanel');
const header = document.getElementById('panelHeader');

header.addEventListener('mousedown', e => {
    if(isMobile()) return;
    isDragging = true;
    xOffset = e.clientX - panel.offsetLeft;
    yOffset = e.clientY - panel.offsetTop;
    panel.style.transition = 'none';
});

document.addEventListener('mousemove', e => {
    if(!isDragging || isMobile()) return;
    panel.style.left = (e.clientX - xOffset) + 'px';
    panel.style.top = (e.clientY - yOffset) + 'px';
    panel.style.transform = 'none';
});

document.addEventListener('mouseup', () => {
    isDragging = false;
    panel.style.transition = 'box-shadow 0.3s ease';
});

// ===== PANEL =====
function openDevPanel() {
    if(isMobile()) return;
    panel.classList.add('open');
    updateCategorySelect();
    loadColors();
}

function closeDevPanel() {
    panel.classList.remove('open');
    document.body.classList.remove('delete-mode', 'edit-mode');
}

// ===== KATEGORÄ° =====
function updateCategorySelect() {
    let select = document.getElementById('categorySelect');
    select.innerHTML = '';
    document.querySelectorAll('.card').forEach((card, i) => {
        let opt = document.createElement('option');
        opt.value = i;
        opt.textContent = card.querySelector('h3').innerText;
        select.appendChild(opt);
    });
}

function addCategory() {
    if(isMobile()) return;
    let name = document.getElementById('newCategory').value.trim();
    if(!name) return;
    
    let card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `<h3>${name}</h3><button class="delete-card-btn" onclick="deleteCard(this)">âœ•</button>`;
    document.getElementById('menu').appendChild(card);
    
    document.getElementById('newCategory').value = '';
    updateCategorySelect();
    saveAndBroadcast();
}

function addProduct() {
    if(isMobile()) return;
    
    let cat = document.getElementById('categorySelect').value;
    let name = document.getElementById('productName').value.trim();
    let price = document.getElementById('productPrice').value.trim();
    
    if(!name || !price) return;
    
    let item = document.createElement('div');
    item.className = 'item';
    item.innerHTML = `<span class="name">${name}</span><span class="item-price">${price}â‚º</span>`;
    
    document.querySelectorAll('.card')[cat].appendChild(item);
    
    document.getElementById('productName').value = '';
    document.getElementById('productPrice').value = '';
    saveAndBroadcast();
}

function deleteCard(btn) {
    if(isMobile()) return;
    if(confirm('Sil?')) {
        btn.closest('.card').remove();
        updateCategorySelect();
        saveAndBroadcast();
    }
}

// ===== RENKLER =====
function loadColors() {
    document.getElementById('colorCategory').value = localStorage.getItem('colorCategory') || defaultColors.category;
    document.getElementById('colorName').value = localStorage.getItem('colorName') || defaultColors.name;
    document.getElementById('colorPrice').value = localStorage.getItem('colorPrice') || defaultColors.price;
    document.getElementById('colorButton').value = localStorage.getItem('colorButton') || defaultColors.button;
    applyColors();
}

function applyColors() {
    let colors = {
        category: document.getElementById('colorCategory').value,
        name: document.getElementById('colorName').value,
        price: document.getElementById('colorPrice').value,
        button: document.getElementById('colorButton').value
    };
    
    document.querySelectorAll('.card h3').forEach(el => el.style.color = colors.category);
    document.querySelectorAll('.name').forEach(el => el.style.color = colors.name);
    document.querySelectorAll('.item-price').forEach(el => el.style.color = colors.price);
    document.querySelectorAll('.btn, .dev-panel button:not(.save-btn):not(.delete-btn):not(.close-btn)').forEach(el => {
        el.style.background = colors.button;
    });
    
    Object.keys(colors).forEach(key => localStorage.setItem('color' + key, colors[key]));
}

function applyColorsFromData(colors) {
    document.querySelectorAll('.card h3').forEach(el => el.style.color = colors.category);
    document.querySelectorAll('.name').forEach(el => el.style.color = colors.name);
    document.querySelectorAll('.item-price').forEach(el => el.style.color = colors.price);
    document.querySelectorAll('.btn, .dev-panel button:not(.save-btn):not(.delete-btn):not(.close-btn)').forEach(el => {
        el.style.background = colors.button;
    });
}

function resetColors() {
    document.getElementById('colorCategory').value = defaultColors.category;
    document.getElementById('colorName').value = defaultColors.name;
    document.getElementById('colorPrice').value = defaultColors.price;
    document.getElementById('colorButton').value = defaultColors.button;
    applyColors();
    saveAndBroadcast();
}

// ===== MODLAR =====
function toggleDeleteMode() {
    if(isMobile()) return;
    deleteMode = !deleteMode;
    document.body.classList.toggle('delete-mode', deleteMode);
    document.body.classList.remove('edit-mode');
    editMode = false;
}

function toggleEditMode() {
    if(isMobile()) return;
    editMode = !editMode;
    document.body.classList.toggle('edit-mode', editMode);
    document.body.classList.remove('delete-mode');
    deleteMode = false;
    
    document.querySelectorAll('.item-price').forEach(el => {
        el.contentEditable = editMode;
    });
}

// ÃœrÃ¼n silme
document.addEventListener('click', function(e) {
    if(isMobile() || !deleteMode) return;
    let item = e.target.closest('.item');
    if(item && confirm('Sil?')) {
        item.remove();
        saveAndBroadcast();
    }
});

// ===== INSTAGRAM & KONUM =====
function updateInstagram() {
    if(isMobile()) return;
    let link = prompt('Yeni Instagram linki:', 'https://www.instagram.com/tosttooyevski/');
    if(link) {
        document.getElementById('instaLink').href = link;
        saveAndBroadcast();
    }
}

function updateLocation() {
    if(isMobile()) return;
    let loc = prompt('Yeni konum (Ã¶rn: 36.484479,32.101147):');
    if(loc) {
        document.getElementById('mapFrame').src = `https://www.google.com/maps?q=${loc}&output=embed`;
        saveAndBroadcast();
    }
}

// ===== SUPABASE KAYIT + CANLI YAYIN =====
async function saveAndBroadcast() {
    showStatus('ğŸ”„ Kaydediliyor...', 'loading');
    
    try {
        const data = {
            menu: document.getElementById('menu').innerHTML,
            instagram: document.getElementById('instaLink').href,
            location: document.getElementById('mapFrame').src,
            colors: {
                category: document.getElementById('colorCategory')?.value || defaultColors.category,
                name: document.getElementById('colorName')?.value || defaultColors.name,
                price: document.getElementById('colorPrice')?.value || defaultColors.price,
                button: document.getElementById('colorButton')?.value || defaultColors.button
            }
        };
        
        // Supabase'e kaydet
        await supabase.from('settings').update({
            menu_data: data.menu,
            instagram: data.instagram,
            location: data.location,
            colors: JSON.stringify(data.colors)
        }).eq('id', 1);
        
        // CanlÄ± yayÄ±nla
        await broadcastChannel.send({
            type: 'broadcast',
            event: 'menu-changed',
            payload: { type: 'menu', data: data.menu }
        });
        
        await broadcastChannel.send({
            type: 'broadcast',
            event: 'menu-changed',
            payload: { type: 'instagram', data: data.instagram }
        });
        
        await broadcastChannel.send({
            type: 'broadcast',
            event: 'menu-changed',
            payload: { type: 'location', data: data.location }
        });
        
        await broadcastChannel.send({
            type: 'broadcast',
            event: 'menu-changed',
            payload: { type: 'colors', data: data.colors }
        });
        
        showStatus('âœ… Herkese gÃ¶nderildi!', 'success');
    } catch(err) {
        console.error(err);
        showStatus('âŒ Hata!', 'error');
    }
}

// ===== DURUM MESAJI =====
function showStatus(msg, type) {
    let old = document.querySelector('.status-message');
    if(old) old.remove();
    
    let div = document.createElement('div');
    div.className = `status-message status-${type}`;
    div.innerText = msg;
    document.body.appendChild(div);
    setTimeout(() => div.remove(), 3000);
}

// ===== BAÅLANGIÃ‡ =====
window.onload = async function() {
    // Supabase'den yÃ¼kle
    const { data } = await supabase.from('settings').select('*').eq('id', 1).single();
    
    if(data) {
        if(data.menu_data) document.getElementById('menu').innerHTML = data.menu_data;
        if(data.instagram) document.getElementById('instaLink').href = data.instagram;
        if(data.location) document.getElementById('mapFrame').src = data.location;
        if(data.colors) {
            let colors = JSON.parse(data.colors);
            applyColorsFromData(colors);
            localStorage.setItem('colorCategory', colors.category);
            localStorage.setItem('colorName', colors.name);
            localStorage.setItem('colorPrice', colors.price);
            localStorage.setItem('colorButton', colors.button);
        }
    }
    
    updateCategorySelect();
    loadColors();
};
</script>

</body>
</html>
